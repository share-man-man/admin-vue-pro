import{x as F,y as z,z as le,d as m,U as L,_ as h,B as Pe,o as Ie,C as U,D as se,a as Me,g as _e,E as Y,F as R,j as ue,G as Ge,H as Te,I as ce,J as I,u as E,n as de,A as je,q as De,K as ge,f as H,e as X,c as Z,i as K,L as Re,M as We,N as ze,t as B,O as J,s as Q,k as Le,m as Be,Q as Ve,R as W,h as Ne,p as $e,S as ve,V as qe,W as Ue,X as Ye,Y as He,P as Xe,Z as Ze}from"./workspace.e4230160.js";import{a as Ke}from"./Content.a3f02a4b.js";import{d as he,E as fe,w as pe,i as j,l as ee}from"./vendor.0aef34f5.js";import{I as Je}from"./Input.8b770423.js";import{C as Qe}from"./Card.d5621784.js";import"./oauth.a753370a.js";import"./debounce.b47df357.js";import"./index.75ac00a3.js";import"./createChainedFunction.2d5d7d53.js";import"./ExclamationCircleFilled.7a9ee298.js";import"./CloseCircleFilled.4ca4922c.js";import"./LoadingOutlined.e8e7e3ee.js";import"./CloseCircleOutlined.99fb16f4.js";import"./InfoCircleOutlined.354af1bf.js";import"./code.aa7872b2.js";import"./index.de3dd9d1.js";import"./antInputDirective.dcf4b893.js";import"./index.9563d230.js";import"./index.ed5ee94f.js";import"./tabs.be0aa087.js";import"./LeftOutlined.14b5f9c0.js";import"./Col.b260d2ad.js";function et(e,t,r){r===void 0&&(r=0);for(var i=r;i<e.length;i++)if(t(e[i],i))return i;return-1}function k(e,t){return e.views.find(function(r){return r.id===t})}function V(e){return typeof e=="number"&&!isNaN(e)}function tt(e,t,r){var i=Math.min(t,r),n=Math.max(t,r);return e>=i&&e<=n}function rt(e,t){var r=e.filter(function(o){var a=F(o,[t]);return z(a)&&!isNaN(a)}),i=r.every(function(o){return F(o,[t])>=0}),n=r.every(function(o){return F(o,[t])<=0});return i?{min:0}:n?{max:0}:{}}function it(e){if(z(e))return[e,e,e,e];if(le(e)){var t=e.length;if(t===1)return[e[0],e[0],e[0],e[0]];if(t===2)return[e[0],e[1],e[0],e[1]];if(t===3)return[e[0],e[1],e[2],e[1]];if(t===4)return e}return[0,0,0,0]}function N(){return typeof window=="object"?window==null?void 0:window.devicePixelRatio:2}function te(e,t){t===void 0&&(t=e);var r=document.createElement("canvas"),i=N();r.width=e*i,r.height=t*i,r.style.width=e+"px",r.style.height=t+"px";var n=r.getContext("2d");return n.scale(i,i),r}function re(e,t,r,i){i===void 0&&(i=r);var n=t.backgroundColor,o=t.opacity;e.globalAlpha=o,e.fillStyle=n,e.beginPath(),e.fillRect(0,0,r,i),e.closePath()}function me(e,t,r){var i=e+t;return r?i*2:i}function ye(e,t){var r=t?[[e*(1/4),e*(1/4)],[e*(3/4),e*(3/4)]]:[[e*(1/2),e*(1/2)]];return r}function ie(e,t){var r=t*Math.PI/180,i={a:Math.cos(r)*(1/e),b:Math.sin(r)*(1/e),c:-Math.sin(r)*(1/e),d:Math.cos(r)*(1/e),e:0,f:0};return i}var nt={size:6,padding:2,backgroundColor:"transparent",opacity:1,rotation:0,fill:"#fff",fillOpacity:.5,stroke:"transparent",lineWidth:0,isStagger:!0};function ot(e,t,r,i){var n=t.size,o=t.fill,a=t.lineWidth,s=t.stroke,l=t.fillOpacity;e.beginPath(),e.globalAlpha=l,e.fillStyle=o,e.strokeStyle=s,e.lineWidth=a,e.arc(r,i,n/2,0,2*Math.PI,!1),e.fill(),a&&e.stroke(),e.closePath()}function at(e){var t=m({},nt,e),r=t.size,i=t.padding,n=t.isStagger,o=t.rotation,a=me(r,i,n),s=ye(a,n),l=te(a,a),u=l.getContext("2d");re(u,t,a);for(var g=0,d=s;g<d.length;g++){var c=d[g],v=c[0],p=c[1];ot(u,t,v,p)}var y=u.createPattern(l,"repeat");if(y){var b=N(),f=ie(b,o);y.setTransform(f)}return y}var lt={rotation:45,spacing:5,opacity:1,backgroundColor:"transparent",strokeOpacity:.5,stroke:"#fff",lineWidth:2};function st(e,t,r){var i=t.stroke,n=t.lineWidth,o=t.strokeOpacity,a=new Path2D(r);e.globalAlpha=o,e.lineCap="square",e.strokeStyle=n?i:"transparent",e.lineWidth=n,e.stroke(a)}function ut(e){var t=m({},lt,e),r=t.spacing,i=t.rotation,n=t.lineWidth,o=r+n||1,a=r+n||1,s=`
            M 0 0 L `+o+` 0
            M 0 `+a+" L "+o+" "+a+`
            `,l=te(o,a),u=l.getContext("2d");re(u,t,o,a),st(u,t,s);var g=u.createPattern(l,"repeat");if(g){var d=N(),c=ie(d,i);g.setTransform(c)}return g}var ct={size:6,padding:1,isStagger:!0,backgroundColor:"transparent",opacity:1,rotation:0,fill:"#fff",fillOpacity:.5,stroke:"transparent",lineWidth:0};function dt(e,t,r,i){var n=t.stroke,o=t.size,a=t.fill,s=t.lineWidth,l=t.fillOpacity;e.globalAlpha=l,e.strokeStyle=n,e.lineWidth=s,e.fillStyle=a,e.strokeRect(r-o/2,i-o/2,o,o),e.fillRect(r-o/2,i-o/2,o,o)}function gt(e){var t=m({},ct,e),r=t.size,i=t.padding,n=t.isStagger,o=t.rotation,a=me(r,i,n),s=ye(a,n),l=te(a,a),u=l.getContext("2d");re(u,t,a);for(var g=0,d=s;g<d.length;g++){var c=d[g],v=c[0],p=c[1];dt(u,t,v,p)}var y=u.createPattern(l,"repeat");if(y){var b=N(),f=ie(b,o);y.setTransform(f)}return y}function vt(e){var t=e.type,r=e.cfg,i;switch(t){case"dot":i=at(r);break;case"line":i=ut(r);break;case"square":i=gt(r);break}return i}function ht(e){var t=this;return function(r){var i,n=r.options,o=r.chart,a=n.pattern;if(!a)return r;var s=function(l){for(var u,g,d,c=[],v=1;v<arguments.length;v++)c[v-1]=arguments[v];var p=o.getTheme().defaultColor,y=p,b=(g=(u=o.geometries)===null||u===void 0?void 0:u[0])===null||g===void 0?void 0:g.getAttribute("color");if(b){var f=b.getFields()[0],w=F(l,f);y=L.getMappingValue(b,w,((d=b.values)===null||d===void 0?void 0:d[0])||p)}var S=a;typeof a=="function"&&(S=a.call(t,l,y)),S instanceof CanvasPattern||(S=vt(m({},{cfg:{backgroundColor:y}},S)));var x=n[e];return h(h({},typeof x=="function"?x.call.apply(x,Pe([t,l],c)):x||{}),{fill:S||y})};return m({},r,{options:(i={},i[e]=s,i)})}}function ft(e){var t=e.chart,r=e.options,i=e.ext,n=r.seriesField,o=r.isGroup,a=r.isStack,s=r.marginRatio,l=r.widthRatio,u=r.groupField,g=r.theme,d=[];if(n&&(o&&d.push({type:"dodge",dodgeBy:u||n,marginRatio:s}),a&&d.push({type:"stack",marginRatio:s})),d.length&&(i==null?void 0:i.geometry)){var c=i==null?void 0:i.geometry;c.adjust(d)}return Ie(l)||t.theme(m({},U(g)?g:se(g),{columnWidthRatio:l})),e}function pt(e){var t=e.options,r=t.xField,i=t.yField,n=t.interval,o=t.seriesField,a=t.tooltip,s=t.minColumnWidth,l=t.maxColumnWidth,u=t.columnBackground,g=t.dodgePadding,d=t.intervalPadding,c=Me(a,[r,i,o]),v=c.fields,p=c.formatter,y=(n?_e(m({},e,{options:{type:"interval",colorField:o,tooltipFields:v,mapping:h({tooltip:p},n),args:{dodgePadding:g,intervalPadding:d,minColumnWidth:s,maxColumnWidth:l,background:u}}})):e).ext;return ft(h(h({},e),{ext:y}))}function be(e,t,r,i){var n=R(e,function(o,a){var s=a[r],l=o.has(s)?o.get(s):0,u=a[t];return l=V(u)?l+u:l,o.set(s,l),o},new Map);return Y(e,function(o){var a,s=o[t],l=o[r],u=V(s)?s/n.get(l):0;return h(h({},o),(a={},a[i]=u,a))})}function mt(e,t,r,i){var n=R(e,function(o,a){var s=R(r,function(g,d){return""+g+a[d]},""),l=o.has(s)?o.get(s):0,u=a[t];return l=V(u)?l+u:l,o.set(s,l),o},new Map);return Y(e,function(o){var a,s=o[t],l=R(r,function(g,d){return""+g+o[d]},""),u=V(s)?s/n.get(l):0;return h(h({},o),(a={},a[i]=u,a))})}function yt(e,t,r,i,n){return n?be(e,t,r,i):e}var D;(function(e){e.Left="Left",e.Right="Right"})(D||(D={}));var M;(function(e){e.Line="line",e.Column="column"})(M||(M={}));var C="left-axes-view",A="right-axes-view",xe={nice:!0,label:{autoHide:!0,autoRotate:!1}},bt=h(h({},xe),{position:"left"}),xt=h(h({},xe),{position:"right",grid:null});function ne(e){return F(e,"geometry")===M.Line}function oe(e){return F(e,"geometry")===M.Column}function ke(e,t,r){return oe(r)?m({},{geometry:M.Column,label:r.label&&r.isRange?{content:function(i){var n;return(n=i[t])===null||n===void 0?void 0:n.join("-")}}:void 0},r):h({geometry:M.Line},r)}function Fe(e,t){var r=e[0],i=e[1];if(le(t)){var n=t[0],o=t[1];return[n,o]}var a=F(t,r),s=F(t,i);return[a,s]}function we(e,t){return t===D.Left?e===!1?!1:m({},bt,e):t===D.Right?e===!1?!1:m({},xt,e):e}function Se(e){var t=e.view,r=e.geometryOption,i=e.yField,n=e.legend,o=F(n,"marker"),a=ue(t,ne(r)?"line":"interval");if(!r.seriesField){var s=F(t,"options.scales."+i+".alias")||i,l=a.getAttribute("color"),u=t.getTheme().defaultColor;l&&(u=L.getMappingValue(l,s,F(l,["values",0],u)));var g=(Ge(o)?o:!Te(o)&&m({},{style:{stroke:u,fill:u}},o))||(ne(r)?{symbol:function(c,v,p){return[["M",c-p,v],["L",c+p,v]]},style:{lineWidth:2,r:6,stroke:u}}:{symbol:"square",style:{fill:u}});return[{value:i,name:s,marker:g,isGeometry:!0,viewId:t.id}]}var d=a.getGroupAttributes();return R(d,function(c,v){var p=L.getLegendItems(t,a,v,t.getTheme(),o);return c.concat(p)},[])}function kt(e,t){return!z(e)||!z(t)?"-":e===t?"100%":e===0?"\u221E":t===0?"-\u221E":(100*t/e).toFixed(2)+"%"}function Ft(e,t){return m({size:t?32:80,spacing:t?8:12,offset:t?32:0,arrow:e.arrow!==!1&&{headSize:12,style:{fill:"rgba(0, 0, 0, 0.05)"}},text:e.text!==!1&&{style:{fontSize:12,fill:"rgba(0, 0, 0, 0.85)",textAlign:"center",textBaseline:"middle"},formatter:kt}},e)}function $(e,t){return Y(t.getModel().points,function(r){return e.convertPoint(r)})}function wt(e,t,r){var i=e.view,n=e.geometry,o=e.group,a=e.options,s=e.horizontal,l=a.offset,u=a.size,g=a.arrow,d=i.getCoordinate(),c=$(d,t)[s?3:0],v=$(d,r)[s?0:3],p=v.y-c.y,y=v.x-c.x;if(typeof g!="boolean"){var b=g.headSize,f=a.spacing,w;s?(y-b)/2<f?(f=Math.max(1,(y-b)/2),w=[[c.x+f,c.y-l],[c.x+f,c.y-l-u],[v.x-f,v.y-l-u/2]]):w=[[c.x+f,c.y-l],[c.x+f,c.y-l-u],[v.x-f-b,v.y-l-u],[v.x-f,v.y-l-u/2],[v.x-f-b,v.y-l]]:(p-b)/2<f?(f=Math.max(1,(p-b)/2),w=[[c.x+l,c.y+f],[c.x+l+u,c.y+f],[v.x+l+u/2,v.y-f]]):w=[[c.x+l,c.y+f],[c.x+l+u,c.y+f],[v.x+l+u,v.y-f-b],[v.x+l+u/2,v.y-f],[v.x+l,v.y-f-b]],o.addShape("polygon",{id:i.id+"-conversion-tag-arrow-"+n.getElementId(t.getModel().mappingData),name:"conversion-tag-arrow",origin:{element:t,nextElement:r},attrs:h(h({},g.style||{}),{points:w})})}}function St(e,t,r){var i,n,o,a=e.view,s=e.geometry,l=e.group,u=e.options,g=e.field,d=e.horizontal,c=u.offset,v=u.size;if(typeof u.text!="boolean"){var p=a.getCoordinate(),y=((i=u.text)===null||i===void 0?void 0:i.formatter)&&((n=u.text)===null||n===void 0?void 0:n.formatter(t.getData()[g],r.getData()[g])),b=$(p,t)[d?3:0],f=$(p,r)[d?0:3],w=l.addShape("text",{id:a.id+"-conversion-tag-text-"+s.getElementId(t.getModel().mappingData),name:"conversion-tag-text",origin:{element:t,nextElement:r},attrs:h(h({},((o=u.text)===null||o===void 0?void 0:o.style)||{}),{text:y,x:d?(b.x+f.x)/2:b.x+c+v/2,y:d?b.y-c-v/2:(b.y+f.y)/2})});if(d){var S=f.x-b.x,x=w.getBBox().width;if(x>S){var T=x/y.length,P=Math.max(1,Math.ceil(S/T)-1),q=y.slice(0,P)+"...";w.attr("text",q)}}}}function Ct(e,t,r){wt(e,t,r),St(e,t,r)}function At(e,t,r){return t===void 0&&(t=!0),r===void 0&&(r=!1),function(i){var n=i.options,o=i.chart,a=n.conversionTag,s=n.theme;return a&&!r&&(o.theme(m({},U(s)?s:se(s),{columnWidthRatio:1/3})),o.annotation().shape({render:function(l,u){var g=l.addGroup({id:o.id+"-conversion-tag-group",name:"conversion-tag-group"}),d=ce(o.geometries,function(p){return p.type==="interval"}),c={view:u,geometry:d,group:g,field:e,horizontal:t,options:Ft(a,t)},v=t?d.elements:d.elements.slice().reverse();I(v,function(p,y){y>0&&Ct(c,v[y-1],p)})}})),i}}var _={hover:"__interval-connected-area-hover__",click:"__interval-connected-area-click__"},ae=function(e,t){return e==="hover"?[{trigger:"interval:mouseenter",action:["element-highlight-by-color:highlight","element-link-by-color:link"],arg:[null,{style:t}]}]:[{trigger:"interval:click",action:["element-highlight-by-color:clear","element-highlight-by-color:highlight","element-link-by-color:clear","element-link-by-color:unlink","element-link-by-color:link"],arg:[null,null,null,null,{style:t}]}]};E(_.hover,{start:ae(_.hover),end:[{trigger:"interval:mouseleave",action:["element-highlight-by-color:reset","element-link-by-color:unlink"]}]});E(_.click,{start:ae(_.click),end:[{trigger:"document:mousedown",action:["element-highlight-by-color:clear","element-link-by-color:clear"]}]});function Et(e){return e===void 0&&(e=!1),function(t){var r=t.chart,i=t.options,n=i.connectedArea,o=function(){r.removeInteraction(_.hover),r.removeInteraction(_.click)};if(!e&&n){var a=n.trigger||"hover";o(),r.interaction(_[a],{start:ae(a,n.style)})}else o();return t}}var Ot=10,Pt=5,It={padding:[8,10],text:"reset",textStyle:{default:{x:0,y:0,fontSize:12,fill:"#333333",cursor:"pointer"}},buttonStyle:{default:{fill:"#f7f7f7",stroke:"#cccccc",cursor:"pointer"},active:{fill:"#e6e6e6"}}},Mt=function(e){de(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.buttonGroup=null,r.buttonCfg=h({name:"button"},It),r}return t.prototype.getButtonCfg=function(){var r=this.context.view,i=F(r,["interactions","filter-action","cfg","buttonConfig"]);return m(this.buttonCfg,i,this.cfg)},t.prototype.drawButton=function(){var r=this.getButtonCfg(),i=this.context.view.foregroundGroup.addGroup({name:r.name}),n=this.drawText(i);this.drawBackground(i,n.getBBox()),this.buttonGroup=i},t.prototype.drawText=function(r){var i,n=this.getButtonCfg();return r.addShape({type:"text",name:"button-text",attrs:h({text:n.text},(i=n.textStyle)===null||i===void 0?void 0:i.default)})},t.prototype.drawBackground=function(r,i){var n,o=this.getButtonCfg(),a=it(o.padding),s=r.addShape({type:"rect",name:"button-rect",attrs:h({x:i.x-a[3],y:i.y-a[0],width:i.width+a[1]+a[3],height:i.height+a[0]+a[2]},(n=o.buttonStyle)===null||n===void 0?void 0:n.default)});return s.toBack(),r.on("mouseenter",function(){var l;s.attr((l=o.buttonStyle)===null||l===void 0?void 0:l.active)}),r.on("mouseleave",function(){var l;s.attr((l=o.buttonStyle)===null||l===void 0?void 0:l.default)}),s},t.prototype.resetPosition=function(){var r=this.context.view,i=r.getCoordinate(),n=i.convert({x:1,y:1}),o=this.buttonGroup,a=o.getBBox(),s=L.transform(null,[["t",n.x-a.width-Ot,n.y+a.height+Pt]]);o.setMatrix(s)},t.prototype.show=function(){this.buttonGroup||this.drawButton(),this.resetPosition(),this.buttonGroup.show()},t.prototype.hide=function(){this.buttonGroup&&this.buttonGroup.hide()},t.prototype.destroy=function(){var r=this.buttonGroup;r&&r.remove(),e.prototype.destroy.call(this)},t}(je);De("brush-reset-button",Mt,{name:"brush-reset-button"});E("filter-action",{});function O(e){return e.isInPlot()}function G(e,t,r){var i=t||"rect";switch(e){case"brush":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:O,action:["brush:start",i+"-mask:start",i+"-mask:show"],arg:[null,{maskStyle:r==null?void 0:r.style}]}],processing:[{trigger:"mousemove",isEnable:O,action:[i+"-mask:resize"]}],end:[{trigger:"mouseup",isEnable:O,action:["brush:filter","brush:end",i+"-mask:end",i+"-mask:hide","brush-reset-button:show"]}],rollback:[{trigger:"brush-reset-button:click",action:["brush:reset","brush-reset-button:hide","cursor:crosshair"]}]};case"brush-highlight":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"mask:mouseenter",action:"cursor:move"},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:function(n){return!n.isInShape("mask")},action:[i+"-mask:start",i+"-mask:show"],arg:[{maskStyle:r==null?void 0:r.style}]},{trigger:"mask:dragstart",action:[i+"-mask:moveStart"]}],processing:[{trigger:"plot:mousemove",action:[i+"-mask:resize"]},{trigger:"mask:drag",action:[i+"-mask:move"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:[i+"-mask:end"]},{trigger:"mask:dragend",action:[i+"-mask:moveEnd"]},{trigger:"document:mouseup",isEnable:function(n){return!n.isInPlot()},action:["element-range-highlight:clear",i+"-mask:end",i+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear",i+"-mask:hide"]}]};case"brush-x":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:O,action:["brush-x:start",i+"-mask:start",i+"-mask:show"],arg:[null,{maskStyle:r==null?void 0:r.style}]}],processing:[{trigger:"mousemove",isEnable:O,action:[i+"-mask:resize"]}],end:[{trigger:"mouseup",isEnable:O,action:["brush-x:filter","brush-x:end",i+"-mask:end",i+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["brush-x:reset"]}]};case"brush-x-highlight":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"mask:mouseenter",action:"cursor:move"},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:function(n){return!n.isInShape("mask")},action:[i+"-mask:start",i+"-mask:show"],arg:[{maskStyle:r==null?void 0:r.style}]},{trigger:"mask:dragstart",action:[i+"-mask:moveStart"]}],processing:[{trigger:"plot:mousemove",action:[i+"-mask:resize"]},{trigger:"mask:drag",action:[i+"-mask:move"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:[i+"-mask:end"]},{trigger:"mask:dragend",action:[i+"-mask:moveEnd"]},{trigger:"document:mouseup",isEnable:function(n){return!n.isInPlot()},action:["element-range-highlight:clear",i+"-mask:end",i+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear",i+"-mask:hide"]}]};case"brush-y":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:O,action:["brush-y:start",i+"-mask:start",i+"-mask:show"],arg:[null,{maskStyle:r==null?void 0:r.style}]}],processing:[{trigger:"mousemove",isEnable:O,action:[i+"-mask:resize"]}],end:[{trigger:"mouseup",isEnable:O,action:["brush-y:filter","brush-y:end",i+"-mask:end",i+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["brush-y:reset"]}]};case"brush-y-highlight":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"mask:mouseenter",action:"cursor:move"},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:function(n){return!n.isInShape("mask")},action:[i+"-mask:start",i+"-mask:show"],arg:[{maskStyle:r==null?void 0:r.style}]},{trigger:"mask:dragstart",action:[i+"-mask:moveStart"]}],processing:[{trigger:"plot:mousemove",action:[i+"-mask:resize"]},{trigger:"mask:drag",action:[i+"-mask:move"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:[i+"-mask:end"]},{trigger:"mask:dragend",action:[i+"-mask:moveEnd"]},{trigger:"document:mouseup",isEnable:function(n){return!n.isInPlot()},action:["element-range-highlight:clear",i+"-mask:end",i+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear",i+"-mask:hide"]}]};default:return{}}}E("brush",G("brush"));E("brush-highlight",G("brush-highlight"));E("brush-x",G("brush-x","x-rect"));E("brush-y",G("brush-y","y-rect"));E("brush-x-highlight",G("brush-x-highlight","x-rect"));E("brush-y-highlight",G("brush-y-highlight","y-rect"));var Ce=["brush","brush-x","brush-y","brush-highlight","brush-x-highlight","brush-y-highlight"];function _t(e){var t=e.options,r=t.brush,i=ge(t.interactions||[],function(n){return Ce.indexOf(n.type)===-1});return(r==null?void 0:r.enabled)&&(Ce.forEach(function(n){var o,a=!1;switch(r.type){case"x-rect":a=n===(r.action==="highlight"?"brush-x-highlight":"brush-x");break;case"y-rect":a=n===(r.action==="highlight"?"brush-y-highlight":"brush-y");break;default:a=n===(r.action==="highlight"?"brush-highlight":"brush");break}var s={type:n,enable:a};(((o=r.mask)===null||o===void 0?void 0:o.style)||r.type)&&(s.cfg=G(n,r.type,r.mask)),i.push(s)}),(r==null?void 0:r.action)!=="highlight"&&i.push({type:"filter-action",cfg:{buttonConfig:r.button}})),m({},e,{options:{interactions:i}})}function Gt(e){var t=e.options,r=t.legend,i=t.seriesField,n=t.isStack;return i?r!==!1&&(r=h({position:n?"right-top":"top-left"},r)):r=!1,e.options.legend=r,e}function Tt(e){var t=e.chart,r=e.options,i=r.data,n=r.columnStyle,o=r.color,a=r.columnWidthRatio,s=r.isPercent,l=r.isGroup,u=r.isStack,g=r.xField,d=r.yField,c=r.seriesField,v=r.groupField,p=r.tooltip,y=r.shape,b=s&&l&&u?mt(i,d,[g,v],d):yt(i,d,g,d,s),f=[];u&&c&&!l?b.forEach(function(x){var T=f.find(function(P){return P[g]===x[g]&&P[c]===x[c]});T?T[d]+=x[d]||0:f.push(h({},x))}):f=b,t.data(f);var w=s?h({formatter:function(x){return{name:l&&u?x[c]+" - "+x[v]:x[c]||x[g],value:(Number(x[d])*100).toFixed(2)+"%"}}},p):p,S=m({},e,{options:{data:f,widthRatio:a,tooltip:w,interval:{shape:y,style:n,color:o}}});return pt(S),S}function jt(e){var t,r,i=e.options,n=i.xAxis,o=i.yAxis,a=i.xField,s=i.yField,l=i.data,u=i.isPercent,g=u?{max:1,min:0,minLimit:0,maxLimit:1}:{};return H(Q((t={},t[a]=n,t[s]=o,t),(r={},r[a]={type:"cat"},r[s]=h(h({},rt(l,s)),g),r)))(e)}function Dt(e){var t=e.chart,r=e.options,i=r.xAxis,n=r.yAxis,o=r.xField,a=r.yField;return i===!1?t.axis(o,!1):t.axis(o,i),n===!1?t.axis(a,!1):t.axis(a,n),e}function Rt(e){var t=e.chart,r=e.options,i=r.legend,n=r.seriesField;return i&&n?t.legend(n,i):i===!1&&t.legend(!1),e}function Wt(e){var t=e.chart,r=e.options,i=r.label,n=r.yField,o=r.isRange,a=ue(t,"interval");if(!i)a.label(!1);else{var s=i.callback,l=Le(i,["callback"]);a.label({fields:[n],callback:s,cfg:h({layout:(l==null?void 0:l.position)?void 0:[{type:"interval-adjust-position"},{type:"interval-hide-overlap"},{type:"adjust-color"},{type:"limit-in-plot",cfg:{action:"hide"}}]},Be(o?h({content:function(u){var g;return(g=u[n])===null||g===void 0?void 0:g.join("-")}},l):l))})}return e}function zt(e){var t=e.chart,r=e.options,i=r.tooltip,n=r.isGroup,o=r.isStack,a=r.groupField,s=r.data,l=r.xField,u=r.yField,g=r.seriesField;if(i===!1)t.tooltip(!1);else{var d=i;if(n&&o){var c=(d==null?void 0:d.formatter)||function(v){return{name:v[g]+" - "+v[a],value:v[u]}};d=h(h({},d),{customItems:function(v){var p=[];return I(v,function(y){var b=ge(s,function(f){return Ve(f,W(y.data,[l,g]))});b.forEach(function(f){p.push(h(h(h({},y),{value:f[u],data:f,mappingData:{_origin:f}}),c(f)))})}),p}})}t.tooltip(d)}return e}function Lt(e,t){t===void 0&&(t=!1);var r=e.options,i=r.seriesField;return H(Gt,B,ht("columnStyle"),ze,Tt,jt,Dt,Rt,zt,We,Re,Wt,_t,K,Z,X(),At(r.yField,!t,!!i),Et(!r.isStack),J)(e)}function Bt(e){var t=e.options,r=e.chart,i=t.geometryOption,n=i.isStack,o=i.color,a=i.seriesField,s=i.groupField,l=i.isGroup,u=["xField","yField"];if(ne(i)){Ne(m({},e,{options:h(h(h({},W(t,u)),i),{line:{color:i.color,style:i.lineStyle}})})),$e(m({},e,{options:h(h(h({},W(t,u)),i),{point:i.point&&h({color:o,shape:"circle"},i.point)})}));var g=[];l&&g.push({type:"dodge",dodgeBy:s||a,customOffset:0}),n&&g.push({type:"stack"}),g.length&&I(r.geometries,function(d){d.adjust(g)})}return oe(i)&&Lt(m({},e,{options:h(h(h({},W(t,u)),i),{widthRatio:i.columnWidthRatio,interval:h(h({},W(i,["color"])),{style:i.columnStyle})})})),e}var Ae=function(e,t){var r=t[0],i=t[1],n=e.getOptions().data,o=e.getXScale(),a=ve(n);if(!(!o||!a)){var s=qe(n,o.field),l=s,u=ve(l),g=Math.floor(r*(u-1)),d=Math.floor(i*(u-1));e.filter(o.field,function(c){var v=l.indexOf(c);return v>-1?tt(v,g,d):!0}),e.render(!0)}};function Vt(e){var t,r=e.options,i=r.geometryOptions,n=i===void 0?[]:i,o=r.xField,a=r.yField,s=Ue(n,function(l){var u=l.geometry;return u===M.Line||u===void 0});return m({},{options:{geometryOptions:[],meta:(t={},t[o]={type:"cat",sync:!0,range:s?[0,1]:void 0},t),tooltip:{showMarkers:s,showCrosshairs:s,shared:!0,crosshairs:{type:"x"}},interactions:s?[{type:"legend-visible-filter"}]:[{type:"legend-visible-filter"},{type:"active-region"}],legend:{position:"top-left"}}},e,{options:{yAxis:Fe(a,r.yAxis),geometryOptions:[ke(o,a[0],n[0]),ke(o,a[1],n[1])],annotations:Fe(a,r.annotations)}})}function Nt(e){var t,r,i=e.chart,n=e.options,o=n.geometryOptions,a={line:0,column:1},s=[{type:(t=o[0])===null||t===void 0?void 0:t.geometry,id:C},{type:(r=o[1])===null||r===void 0?void 0:r.geometry,id:A}];return s.sort(function(l,u){return-a[l.type]+a[u.type]}).forEach(function(l){return i.createView({id:l.id})}),e}function $t(e){var t=e.chart,r=e.options,i=r.xField,n=r.yField,o=r.geometryOptions,a=r.data,s=r.tooltip,l=[h(h({},o[0]),{id:C,data:a[0],yField:n[0]}),h(h({},o[1]),{id:A,data:a[1],yField:n[1]})];return l.forEach(function(u){var g=u.id,d=u.data,c=u.yField,v=oe(u)&&u.isPercent,p=v?be(d,c,i,c):d,y=k(t,g).data(p),b=v?h({formatter:function(f){return{name:f[u.seriesField]||c,value:(Number(f[c])*100).toFixed(2)+"%"}}},s):s;Bt({chart:y,options:{xField:i,yField:c,tooltip:b,geometryOption:u}})}),e}function qt(e){var t,r=e.chart,i=e.options,n=i.geometryOptions,o=((t=r.getTheme())===null||t===void 0?void 0:t.colors10)||[],a=0;return r.once("beforepaint",function(){I(n,function(s,l){var u=k(r,l===0?C:A);if(!s.color){var g=u.getGroupScales(),d=F(g,[0,"values","length"],1),c=o.slice(a,a+d).concat(l===0?[]:o);u.geometries.forEach(function(v){s.seriesField?v.color(s.seriesField,c):v.color(c[0])}),a+=d}}),r.render(!0)}),e}function Ut(e){var t,r,i=e.chart,n=e.options,o=n.xAxis,a=n.yAxis,s=n.xField,l=n.yField;return Q((t={},t[s]=o,t[l[0]]=a[0],t))(m({},e,{chart:k(i,C)})),Q((r={},r[s]=o,r[l[1]]=a[1],r))(m({},e,{chart:k(i,A)})),e}function Yt(e){var t=e.chart,r=e.options,i=k(t,C),n=k(t,A),o=r.xField,a=r.yField,s=r.xAxis,l=r.yAxis;return t.axis(o,!1),t.axis(a[0],!1),t.axis(a[1],!1),i.axis(o,s),i.axis(a[0],we(l[0],D.Left)),n.axis(o,!1),n.axis(a[1],we(l[1],D.Right)),e}function Ht(e){var t=e.chart,r=e.options,i=r.tooltip,n=k(t,C),o=k(t,A);return t.tooltip(i),n.tooltip({shared:!0}),o.tooltip({shared:!0}),e}function Xt(e){var t=e.chart;return K(m({},e,{chart:k(t,C)})),K(m({},e,{chart:k(t,A)})),e}function Zt(e){var t=e.chart,r=e.options,i=r.annotations,n=F(i,[0]),o=F(i,[1]);return X(n)(m({},e,{chart:k(t,C),options:{annotations:n}})),X(o)(m({},e,{chart:k(t,A),options:{annotations:o}})),e}function Kt(e){var t=e.chart;return B(m({},e,{chart:k(t,C)})),B(m({},e,{chart:k(t,A)})),B(e),e}function Jt(e){var t=e.chart;return Z(m({},e,{chart:k(t,C)})),Z(m({},e,{chart:k(t,A)})),e}function Qt(e){var t=e.chart,r=e.options,i=r.yAxis;return J(m({},e,{chart:k(t,C),options:{yAxis:i[0]}})),J(m({},e,{chart:k(t,A),options:{yAxis:i[1]}})),e}function er(e){var t=e.chart,r=e.options,i=r.legend,n=r.geometryOptions,o=r.yField,a=r.data,s=k(t,C),l=k(t,A);if(i===!1)t.legend(!1);else if(U(i)&&i.custom===!0)t.legend(i);else{var u=F(n,[0,"legend"],i),g=F(n,[1,"legend"],i);t.once("beforepaint",function(){var d=a[0].length?Se({view:s,geometryOption:n[0],yField:o[0],legend:u}):[],c=a[1].length?Se({view:l,geometryOption:n[1],yField:o[1],legend:g}):[];t.legend(m({},i,{custom:!0,items:d.concat(c)}))}),n[0].seriesField&&s.legend(n[0].seriesField,u),n[1].seriesField&&l.legend(n[1].seriesField,g),t.on("legend-item:click",function(d){var c=F(d,"gEvent.delegateObject",{});if(c&&c.item){var v=c.item,p=v.value,y=v.isGeometry,b=v.viewId;if(y){var f=et(o,function(x){return x===p});if(f>-1){var w=F(k(t,b),"geometries");I(w,function(x){x.changeVisible(!c.item.unchecked)})}}else{var S=F(t.getController("legend"),"option.items",[]);I(t.views,function(x){var T=x.getGroupScales();I(T,function(P){P.values&&P.values.indexOf(p)>-1&&x.filter(P.field,function(q){var Ee=ce(S,function(Oe){return Oe.value===q});return!Ee.unchecked})}),t.render(!0)})}}})}return e}function tr(e){var t=e.chart,r=e.options,i=r.slider,n=k(t,C),o=k(t,A);return i&&(n.option("slider",i),n.on("slider:valuechanged",function(a){var s=a.event,l=s.value,u=s.originValue;Ye(l,u)||Ae(o,l)}),t.once("afterpaint",function(){if(!He(i)){var a=i.start,s=i.end;(a||s)&&Ae(o,[a,s])}})),e}function rr(e){return H(Vt,Nt,Kt,$t,Ut,Yt,Qt,Ht,Xt,Zt,Jt,qt,er,tr)(e)}var ir=function(e){de(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="dual-axes",r}return t.prototype.getDefaultOptions=function(){return m({},e.prototype.getDefaultOptions.call(this),{yAxis:[],syncViewPadding:!0})},t.prototype.getSchemaAdaptor=function(){return rr},t}(Xe),nr=he({props:{data:{type:Object,default:()=>({column:[],line:[]})}},setup(e){let t;const r={data:[e.data.column,e.data.line],xField:"date",yField:["value","count"],geometryOptions:[{geometry:"column",isStack:!0,seriesField:"type"},{geometry:"line",label:{style:{fill:"#626681"}}}]};return fe(()=>{t=new ir("columnContainer",r),t.render()}),pe(e.data,i=>{t.changeData([i.column,i.line])}),()=>j("div",{id:"columnContainer"},null)}});const or=e=>{const t={};return e.forEach(r=>{t[r.date]>=0?t[r.date]=t[r.date]+r.value:t[r.date]=r.value}),Object.entries(t).map(([r,i])=>({date:r,count:i}))},ar=e=>e.reduce((t,r)=>t+r.value,0);var Pr=he({setup(){const e=ee(!0),t=ee({column:[],line:[]}),r=ee(""),i=async()=>{const n=await Ze();t.value.column.splice(0,n.length,...n),t.value.line=or(t.value.column),e.value=!1};return fe(()=>{e.value=!1}),pe(r,n=>{btoa(n)==="MzMz"&&i()}),()=>j(Ke,null,{default:()=>[j(Je,{value:r.value,"onUpdate:value":n=>r.value=n},null),j(Qe,{title:`\u603B\u8BA1\u8425\u6536\uFF1A${ar([...t.value.column])}`,style:{"margin-bottom":"24px"},loading:e.value,bordered:!1,"body-style":{padding:0}},{default:()=>[j("div",{style:"min-height: 400px;margin:12px 24px"},[j(nr,{data:t.value},null)])]})]})}});export{Pr as default};
