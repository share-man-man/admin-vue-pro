import{x as F,y as B,z as ht,d as y,U as V,_ as h,B as Et,o as Ot,C as J,D as ft,a as It,g as _t,E as Q,F as L,j as pt,G as Gt,H as Tt,I as mt,J as I,q as E,n as yt,A as Dt,u as Mt,K as bt,f as tt,e as Y,c as U,i as H,L as Rt,M as Wt,N as Lt,O as zt,t as z,Q as X,s as Z,k as Bt,m as Vt,R as Nt,S as R,h as jt,p as $t,V as at,W as qt,X as Yt,Y as Ut,Z as Ht,P as Xt,$ as Zt}from"./workspace.6291408d.js";import{a as Kt}from"./Content.04b38a87.js";import{d as xt,x as kt,w as Jt,a as W,r as lt}from"./index.e1409c94.js";import{C as Qt}from"./Card.72d41c0d.js";import"./oauth.2cca38c9.js";import"./debounce.63695ae7.js";import"./index.ec74e710.js";import"./createChainedFunction.2d5d7d53.js";import"./ExclamationCircleFilled.9f777fc4.js";import"./CloseCircleFilled.4dc39271.js";import"./LoadingOutlined.3103cde2.js";import"./CloseCircleOutlined.28f2dbdb.js";import"./InfoCircleOutlined.9f8a4fb5.js";import"./code.aa7872b2.js";import"./index.580754a0.js";import"./tabs.e87a6b5b.js";import"./LeftOutlined.38c21891.js";import"./Col.8566bedb.js";function te(t,e,r){r===void 0&&(r=0);for(var i=r;i<t.length;i++)if(e(t[i],i))return i;return-1}function k(t,e){return t.views.find(function(r){return r.id===e})}function N(t){return typeof t=="number"&&!isNaN(t)}function ee(t,e,r){var i=Math.min(e,r),n=Math.max(e,r);return t>=i&&t<=n}function re(t,e){if(!t)return{};var r=t.filter(function(o){var a=F(o,[e]);return B(a)&&!isNaN(a)}),i=r.every(function(o){return F(o,[e])>=0}),n=r.every(function(o){return F(o,[e])<=0});return i?{min:0}:n?{max:0}:{}}function ie(t){if(B(t))return[t,t,t,t];if(ht(t)){var e=t.length;if(e===1)return[t[0],t[0],t[0],t[0]];if(e===2)return[t[0],t[1],t[0],t[1]];if(e===3)return[t[0],t[1],t[2],t[1]];if(e===4)return t}return[0,0,0,0]}function $(){return typeof window=="object"?window==null?void 0:window.devicePixelRatio:2}function et(t,e){e===void 0&&(e=t);var r=document.createElement("canvas"),i=$();r.width=t*i,r.height=e*i,r.style.width=t+"px",r.style.height=e+"px";var n=r.getContext("2d");return n.scale(i,i),r}function rt(t,e,r,i){i===void 0&&(i=r);var n=e.backgroundColor,o=e.opacity;t.globalAlpha=o,t.fillStyle=n,t.beginPath(),t.fillRect(0,0,r,i),t.closePath()}function Ft(t,e,r){var i=t+e;return r?i*2:i}function wt(t,e){var r=e?[[t*.25,t*.25],[t*.75,t*.75]]:[[t*.5,t*.5]];return r}function it(t,e){var r=e*Math.PI/180,i={a:Math.cos(r)*(1/t),b:Math.sin(r)*(1/t),c:-Math.sin(r)*(1/t),d:Math.cos(r)*(1/t),e:0,f:0};return i}var ne={size:6,padding:2,backgroundColor:"transparent",opacity:1,rotation:0,fill:"#fff",fillOpacity:.5,stroke:"transparent",lineWidth:0,isStagger:!0};function oe(t,e,r,i){var n=e.size,o=e.fill,a=e.lineWidth,s=e.stroke,l=e.fillOpacity;t.beginPath(),t.globalAlpha=l,t.fillStyle=o,t.strokeStyle=s,t.lineWidth=a,t.arc(r,i,n/2,0,2*Math.PI,!1),t.fill(),a&&t.stroke(),t.closePath()}function ae(t){var e=y({},ne,t),r=e.size,i=e.padding,n=e.isStagger,o=e.rotation,a=Ft(r,i,n),s=wt(a,n),l=et(a,a),u=l.getContext("2d");rt(u,e,a);for(var g=0,v=s;g<v.length;g++){var c=v[g],d=c[0],p=c[1];oe(u,e,d,p)}var b=u.createPattern(l,"repeat");if(b){var m=$(),f=it(m,o);b.setTransform(f)}return b}var le={rotation:45,spacing:5,opacity:1,backgroundColor:"transparent",strokeOpacity:.5,stroke:"#fff",lineWidth:2};function se(t,e,r){var i=e.stroke,n=e.lineWidth,o=e.strokeOpacity,a=new Path2D(r);t.globalAlpha=o,t.lineCap="square",t.strokeStyle=n?i:"transparent",t.lineWidth=n,t.stroke(a)}function ue(t){var e=y({},le,t),r=e.spacing,i=e.rotation,n=e.lineWidth,o=r+n||1,a=r+n||1,s=`
            M 0 0 L `+o+` 0
            M 0 `+a+" L "+o+" "+a+`
            `,l=et(o,a),u=l.getContext("2d");rt(u,e,o,a),se(u,e,s);var g=u.createPattern(l,"repeat");if(g){var v=$(),c=it(v,i);g.setTransform(c)}return g}var ce={size:6,padding:1,isStagger:!0,backgroundColor:"transparent",opacity:1,rotation:0,fill:"#fff",fillOpacity:.5,stroke:"transparent",lineWidth:0};function ge(t,e,r,i){var n=e.stroke,o=e.size,a=e.fill,s=e.lineWidth,l=e.fillOpacity;t.globalAlpha=l,t.strokeStyle=n,t.lineWidth=s,t.fillStyle=a,t.strokeRect(r-o/2,i-o/2,o,o),t.fillRect(r-o/2,i-o/2,o,o)}function ve(t){var e=y({},ce,t),r=e.size,i=e.padding,n=e.isStagger,o=e.rotation,a=Ft(r,i,n),s=wt(a,n),l=et(a,a),u=l.getContext("2d");rt(u,e,a);for(var g=0,v=s;g<v.length;g++){var c=v[g],d=c[0],p=c[1];ge(u,e,d,p)}var b=u.createPattern(l,"repeat");if(b){var m=$(),f=it(m,o);b.setTransform(f)}return b}function de(t){var e=t.type,r=t.cfg,i;switch(e){case"dot":i=ae(r);break;case"line":i=ue(r);break;case"square":i=ve(r);break}return i}function he(t){var e=this;return function(r){var i,n=r.options,o=r.chart,a=n.pattern;if(!a)return r;var s=function(l){for(var u,g,v,c=[],d=1;d<arguments.length;d++)c[d-1]=arguments[d];var p=o.getTheme().defaultColor,b=p,m=(g=(u=o.geometries)===null||u===void 0?void 0:u[0])===null||g===void 0?void 0:g.getAttribute("color");if(m){var f=m.getFields()[0],w=F(l,f);b=V.getMappingValue(m,w,((v=m.values)===null||v===void 0?void 0:v[0])||p)}var S=a;typeof a=="function"&&(S=a.call(e,l,b)),S instanceof CanvasPattern||(S=de(y({},{cfg:{backgroundColor:b}},S)));var x=n[t];return h(h({},typeof x=="function"?x.call.apply(x,Et([e,l],c)):x||{}),{fill:S||b})};return y({},r,{options:(i={},i[t]=s,i)})}}function fe(t){var e=t.chart,r=t.options,i=t.ext,n=r.seriesField,o=r.isGroup,a=r.isStack,s=r.marginRatio,l=r.widthRatio,u=r.groupField,g=r.theme,v=[];if(n&&(o&&v.push({type:"dodge",dodgeBy:u||n,marginRatio:s}),a&&v.push({type:"stack",marginRatio:s})),v.length&&(i==null?void 0:i.geometry)){var c=i==null?void 0:i.geometry;c.adjust(v)}return Ot(l)||e.theme(y({},J(g)?g:ft(g),{columnWidthRatio:l})),t}function pe(t){var e=t.options,r=e.xField,i=e.yField,n=e.interval,o=e.seriesField,a=e.tooltip,s=e.minColumnWidth,l=e.maxColumnWidth,u=e.columnBackground,g=e.dodgePadding,v=e.intervalPadding,c=e.useDeferredLabel,d=It(a,[r,i,o]),p=d.fields,b=d.formatter,m=(n?_t(y({},t,{options:{type:"interval",colorField:o,tooltipFields:p,mapping:h({tooltip:b},n),args:{dodgePadding:g,intervalPadding:v,minColumnWidth:s,maxColumnWidth:l,background:u,useDeferredLabel:c}}})):t).ext;return fe(h(h({},t),{ext:m}))}function St(t,e,r,i){var n=L(t,function(o,a){var s=a[r],l=o.has(s)?o.get(s):0,u=a[e];return l=N(u)?l+u:l,o.set(s,l),o},new Map);return Q(t,function(o){var a,s=o[e],l=o[r],u=N(s)&&n.get(l)!==0?s/n.get(l):0;return h(h({},o),(a={},a[i]=u,a))})}function me(t,e,r,i){var n=L(t,function(o,a){var s=L(r,function(g,v){return""+g+a[v]},""),l=o.has(s)?o.get(s):0,u=a[e];return l=N(u)?l+u:l,o.set(s,l),o},new Map);return Q(t,function(o){var a,s=o[e],l=L(r,function(g,v){return""+g+o[v]},""),u=N(s)&&n.get(l)!==0?s/n.get(l):0;return h(h({},o),(a={},a[i]=u,a))})}function ye(t,e,r,i,n){return n?St(t,e,r,i):t}var M;(function(t){t.Left="Left",t.Right="Right"})(M||(M={}));var G;(function(t){t.Line="line",t.Column="column"})(G||(G={}));var C="left-axes-view",A="right-axes-view",Ct={nice:!0,label:{autoHide:!0,autoRotate:!1}},be=h(h({},Ct),{position:"left"}),xe=h(h({},Ct),{position:"right",grid:null});function K(t){return F(t,"geometry")===G.Line}function nt(t){return F(t,"geometry")===G.Column}function st(t,e,r){return nt(r)?y({},{geometry:G.Column,label:r.label&&r.isRange?{content:function(i){var n;return(n=i[e])===null||n===void 0?void 0:n.join("-")}}:void 0},r):h({geometry:G.Line},r)}function ut(t,e){var r=t[0],i=t[1];if(ht(e)){var n=e[0],o=e[1];return[n,o]}var a=F(e,r),s=F(e,i);return[a,s]}function ct(t,e){return e===M.Left?t===!1?!1:y({},be,t):e===M.Right?t===!1?!1:y({},xe,t):t}function gt(t){var e=t.view,r=t.geometryOption,i=t.yField,n=t.legend,o=F(n,"marker"),a=pt(e,K(r)?"line":"interval");if(!r.seriesField){var s=F(e,"options.scales."+i+".alias")||i,l=a.getAttribute("color"),u=e.getTheme().defaultColor;l&&(u=V.getMappingValue(l,s,F(l,["values",0],u)));var g=(Gt(o)?o:!Tt(o)&&y({},{style:{stroke:u,fill:u}},o))||(K(r)?{symbol:function(c,d,p){return[["M",c-p,d],["L",c+p,d]]},style:{lineWidth:2,r:6,stroke:u}}:{symbol:"square",style:{fill:u}});return[{value:i,name:s,marker:g,isGeometry:!0,viewId:e.id}]}var v=a.getGroupAttributes();return L(v,function(c,d){var p=V.getLegendItems(e,a,d,e.getTheme(),o);return c.concat(p)},[])}function ke(t,e){return!B(t)||!B(e)?"-":t===e?"100%":t===0?"\u221E":e===0?"-\u221E":(100*e/t).toFixed(2)+"%"}function Fe(t,e){return y({size:e?32:80,spacing:e?8:12,offset:e?32:0,arrow:t.arrow!==!1&&{headSize:12,style:{fill:"rgba(0, 0, 0, 0.05)"}},text:t.text!==!1&&{style:{fontSize:12,fill:"rgba(0, 0, 0, 0.85)",textAlign:"center",textBaseline:"middle"},formatter:ke}},t)}function j(t,e){return Q(e.getModel().points,function(r){return t.convertPoint(r)})}function we(t,e,r){var i=t.view,n=t.geometry,o=t.group,a=t.options,s=t.horizontal,l=a.offset,u=a.size,g=a.arrow,v=i.getCoordinate(),c=j(v,e)[3],d=j(v,r)[0],p=d.y-c.y,b=d.x-c.x;if(typeof g!="boolean"){var m=g.headSize,f=a.spacing,w;s?(b-m)/2<f?(f=Math.max(1,(b-m)/2),w=[[c.x+f,c.y-l],[c.x+f,c.y-l-u],[d.x-f,d.y-l-u/2]]):w=[[c.x+f,c.y-l],[c.x+f,c.y-l-u],[d.x-f-m,d.y-l-u],[d.x-f,d.y-l-u/2],[d.x-f-m,d.y-l]]:(p-m)/2<f?(f=Math.max(1,(p-m)/2),w=[[c.x+l,c.y+f],[c.x+l+u,c.y+f],[d.x+l+u/2,d.y-f]]):w=[[c.x+l,c.y+f],[c.x+l+u,c.y+f],[d.x+l+u,d.y-f-m],[d.x+l+u/2,d.y-f],[d.x+l,d.y-f-m]],o.addShape("polygon",{id:i.id+"-conversion-tag-arrow-"+n.getElementId(e.getModel().mappingData),name:"conversion-tag-arrow",origin:{element:e,nextElement:r},attrs:h(h({},g.style||{}),{points:w})})}}function Se(t,e,r){var i,n,o,a=t.view,s=t.geometry,l=t.group,u=t.options,g=t.field,v=t.horizontal,c=u.offset,d=u.size;if(typeof u.text!="boolean"){var p=a.getCoordinate(),b=((i=u.text)===null||i===void 0?void 0:i.formatter)&&((n=u.text)===null||n===void 0?void 0:n.formatter(e.getData()[g],r.getData()[g])),m=j(p,e)[v?3:0],f=j(p,r)[v?0:3],w=l.addShape("text",{id:a.id+"-conversion-tag-text-"+s.getElementId(e.getModel().mappingData),name:"conversion-tag-text",origin:{element:e,nextElement:r},attrs:h(h({},((o=u.text)===null||o===void 0?void 0:o.style)||{}),{text:b,x:v?(m.x+f.x)/2:m.x+c+d/2,y:v?m.y-c-d/2:(m.y+f.y)/2})});if(v){var S=f.x-m.x,x=w.getBBox().width;if(x>S){var D=x/b.length,O=Math.max(1,Math.ceil(S/D)-1),q=b.slice(0,O)+"...";w.attr("text",q)}}}}function Ce(t,e,r){we(t,e,r),Se(t,e,r)}function Ae(t,e,r){return e===void 0&&(e=!0),r===void 0&&(r=!1),function(i){var n=i.options,o=i.chart,a=n.conversionTag,s=n.theme;return a&&!r&&(o.theme(y({},J(s)?s:ft(s),{columnWidthRatio:1/3})),o.annotation().shape({render:function(l,u){var g=l.addGroup({id:o.id+"-conversion-tag-group",name:"conversion-tag-group"}),v=mt(o.geometries,function(p){return p.type==="interval"}),c={view:u,geometry:v,group:g,field:t,horizontal:e,options:Fe(a,e)},d=v.elements;I(d,function(p,b){b>0&&Ce(c,d[b-1],p)})}})),i}}var _={hover:"__interval-connected-area-hover__",click:"__interval-connected-area-click__"},ot=function(t,e){return t==="hover"?[{trigger:"interval:mouseenter",action:["element-highlight-by-color:highlight","element-link-by-color:link"],arg:[null,{style:e}]}]:[{trigger:"interval:click",action:["element-highlight-by-color:clear","element-highlight-by-color:highlight","element-link-by-color:clear","element-link-by-color:unlink","element-link-by-color:link"],arg:[null,null,null,null,{style:e}]}]};E(_.hover,{start:ot(_.hover),end:[{trigger:"interval:mouseleave",action:["element-highlight-by-color:reset","element-link-by-color:unlink"]}]});E(_.click,{start:ot(_.click),end:[{trigger:"document:mousedown",action:["element-highlight-by-color:clear","element-link-by-color:clear"]}]});function Pe(t){return t===void 0&&(t=!1),function(e){var r=e.chart,i=e.options,n=i.connectedArea,o=function(){r.removeInteraction(_.hover),r.removeInteraction(_.click)};if(!t&&n){var a=n.trigger||"hover";o(),r.interaction(_[a],{start:ot(a,n.style)})}else o();return e}}var Ee=10,Oe=5,Ie={padding:[8,10],text:"reset",textStyle:{default:{x:0,y:0,fontSize:12,fill:"#333333",cursor:"pointer"}},buttonStyle:{default:{fill:"#f7f7f7",stroke:"#cccccc",cursor:"pointer"},active:{fill:"#e6e6e6"}}},_e=function(t){yt(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.buttonGroup=null,r.buttonCfg=h({name:"button"},Ie),r}return e.prototype.getButtonCfg=function(){var r=this.context.view,i=F(r,["interactions","filter-action","cfg","buttonConfig"]);return y(this.buttonCfg,i,this.cfg)},e.prototype.drawButton=function(){var r=this.getButtonCfg(),i=this.context.view.foregroundGroup.addGroup({name:r.name}),n=this.drawText(i);this.drawBackground(i,n.getBBox()),this.buttonGroup=i},e.prototype.drawText=function(r){var i,n=this.getButtonCfg();return r.addShape({type:"text",name:"button-text",attrs:h({text:n.text},(i=n.textStyle)===null||i===void 0?void 0:i.default)})},e.prototype.drawBackground=function(r,i){var n,o=this.getButtonCfg(),a=ie(o.padding),s=r.addShape({type:"rect",name:"button-rect",attrs:h({x:i.x-a[3],y:i.y-a[0],width:i.width+a[1]+a[3],height:i.height+a[0]+a[2]},(n=o.buttonStyle)===null||n===void 0?void 0:n.default)});return s.toBack(),r.on("mouseenter",function(){var l;s.attr((l=o.buttonStyle)===null||l===void 0?void 0:l.active)}),r.on("mouseleave",function(){var l;s.attr((l=o.buttonStyle)===null||l===void 0?void 0:l.default)}),s},e.prototype.resetPosition=function(){var r=this.context.view,i=r.getCoordinate(),n=i.convert({x:1,y:1}),o=this.buttonGroup,a=o.getBBox(),s=V.transform(null,[["t",n.x-a.width-Ee,n.y+a.height+Oe]]);o.setMatrix(s)},e.prototype.show=function(){this.buttonGroup||this.drawButton(),this.resetPosition(),this.buttonGroup.show()},e.prototype.hide=function(){this.buttonGroup&&this.buttonGroup.hide()},e.prototype.destroy=function(){var r=this.buttonGroup;r&&r.remove(),t.prototype.destroy.call(this)},e}(Dt);Mt("brush-reset-button",_e,{name:"brush-reset-button"});E("filter-action",{});function P(t){return t.isInPlot()}function T(t,e,r){var i=e||"rect";switch(t){case"brush":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:P,action:["brush:start",i+"-mask:start",i+"-mask:show"],arg:[null,{maskStyle:r==null?void 0:r.style}]}],processing:[{trigger:"mousemove",isEnable:P,action:[i+"-mask:resize"]}],end:[{trigger:"mouseup",isEnable:P,action:["brush:filter","brush:end",i+"-mask:end",i+"-mask:hide","brush-reset-button:show"]}],rollback:[{trigger:"brush-reset-button:click",action:["brush:reset","brush-reset-button:hide","cursor:crosshair"]}]};case"brush-highlight":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"mask:mouseenter",action:"cursor:move"},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:function(n){return!n.isInShape("mask")},action:[i+"-mask:start",i+"-mask:show"],arg:[{maskStyle:r==null?void 0:r.style}]},{trigger:"mask:dragstart",action:[i+"-mask:moveStart"]}],processing:[{trigger:"plot:mousemove",action:[i+"-mask:resize"]},{trigger:"mask:drag",action:[i+"-mask:move"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:[i+"-mask:end"]},{trigger:"mask:dragend",action:[i+"-mask:moveEnd"]},{trigger:"document:mouseup",isEnable:function(n){return!n.isInPlot()},action:["element-range-highlight:clear",i+"-mask:end",i+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear",i+"-mask:hide"]}]};case"brush-x":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:P,action:["brush-x:start",i+"-mask:start",i+"-mask:show"],arg:[null,{maskStyle:r==null?void 0:r.style}]}],processing:[{trigger:"mousemove",isEnable:P,action:[i+"-mask:resize"]}],end:[{trigger:"mouseup",isEnable:P,action:["brush-x:filter","brush-x:end",i+"-mask:end",i+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["brush-x:reset"]}]};case"brush-x-highlight":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"mask:mouseenter",action:"cursor:move"},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:function(n){return!n.isInShape("mask")},action:[i+"-mask:start",i+"-mask:show"],arg:[{maskStyle:r==null?void 0:r.style}]},{trigger:"mask:dragstart",action:[i+"-mask:moveStart"]}],processing:[{trigger:"plot:mousemove",action:[i+"-mask:resize"]},{trigger:"mask:drag",action:[i+"-mask:move"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:[i+"-mask:end"]},{trigger:"mask:dragend",action:[i+"-mask:moveEnd"]},{trigger:"document:mouseup",isEnable:function(n){return!n.isInPlot()},action:["element-range-highlight:clear",i+"-mask:end",i+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear",i+"-mask:hide"]}]};case"brush-y":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:P,action:["brush-y:start",i+"-mask:start",i+"-mask:show"],arg:[null,{maskStyle:r==null?void 0:r.style}]}],processing:[{trigger:"mousemove",isEnable:P,action:[i+"-mask:resize"]}],end:[{trigger:"mouseup",isEnable:P,action:["brush-y:filter","brush-y:end",i+"-mask:end",i+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["brush-y:reset"]}]};case"brush-y-highlight":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"mask:mouseenter",action:"cursor:move"},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:function(n){return!n.isInShape("mask")},action:[i+"-mask:start",i+"-mask:show"],arg:[{maskStyle:r==null?void 0:r.style}]},{trigger:"mask:dragstart",action:[i+"-mask:moveStart"]}],processing:[{trigger:"plot:mousemove",action:[i+"-mask:resize"]},{trigger:"mask:drag",action:[i+"-mask:move"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:[i+"-mask:end"]},{trigger:"mask:dragend",action:[i+"-mask:moveEnd"]},{trigger:"document:mouseup",isEnable:function(n){return!n.isInPlot()},action:["element-range-highlight:clear",i+"-mask:end",i+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear",i+"-mask:hide"]}]};default:return{}}}E("brush",T("brush"));E("brush-highlight",T("brush-highlight"));E("brush-x",T("brush-x","x-rect"));E("brush-y",T("brush-y","y-rect"));E("brush-x-highlight",T("brush-x-highlight","x-rect"));E("brush-y-highlight",T("brush-y-highlight","y-rect"));var vt=["brush","brush-x","brush-y","brush-highlight","brush-x-highlight","brush-y-highlight"];function Ge(t){var e=t.options,r=e.brush,i=bt(e.interactions||[],function(n){return vt.indexOf(n.type)===-1});return r!=null&&r.enabled&&(vt.forEach(function(n){var o,a=!1;switch(r.type){case"x-rect":a=n===(r.action==="highlight"?"brush-x-highlight":"brush-x");break;case"y-rect":a=n===(r.action==="highlight"?"brush-y-highlight":"brush-y");break;default:a=n===(r.action==="highlight"?"brush-highlight":"brush");break}var s={type:n,enable:a};(((o=r.mask)===null||o===void 0?void 0:o.style)||r.type)&&(s.cfg=T(n,r.type,r.mask)),i.push(s)}),(r==null?void 0:r.action)!=="highlight"&&i.push({type:"filter-action",cfg:{buttonConfig:r.button}})),y({},t,{options:{interactions:i}})}function Te(t){var e=t.options,r=e.legend,i=e.seriesField,n=e.isStack;return i?r!==!1&&(r=h({position:n?"right-top":"top-left"},r)):r=!1,t.options.legend=r,t}function De(t){var e=t.chart,r=t.options,i=r.data,n=r.columnStyle,o=r.color,a=r.columnWidthRatio,s=r.isPercent,l=r.isGroup,u=r.isStack,g=r.xField,v=r.yField,c=r.seriesField,d=r.groupField,p=r.tooltip,b=r.shape,m=s&&l&&u?me(i,v,[g,d],v):ye(i,v,g,v,s),f=[];u&&c&&!l?m.forEach(function(x){var D=f.find(function(O){return O[g]===x[g]&&O[c]===x[c]});D?D[v]+=x[v]||0:f.push(h({},x))}):f=m,e.data(f);var w=s?h({formatter:function(x){return{name:l&&u?x[c]+" - "+x[d]:x[c]||x[g],value:(Number(x[v])*100).toFixed(2)+"%"}}},p):p,S=y({},t,{options:{data:f,widthRatio:a,tooltip:w,interval:{shape:b,style:n,color:o}}});return pe(S),S}function Me(t){var e,r,i=t.options,n=i.xAxis,o=i.yAxis,a=i.xField,s=i.yField,l=i.data,u=i.isPercent,g=u?{max:1,min:0,minLimit:0,maxLimit:1}:{};return tt(Z((e={},e[a]=n,e[s]=o,e),(r={},r[a]={type:"cat"},r[s]=h(h({},re(l,s)),g),r)))(t)}function Re(t){var e=t.chart,r=t.options,i=r.xAxis,n=r.yAxis,o=r.xField,a=r.yField;return i===!1?e.axis(o,!1):e.axis(o,i),n===!1?e.axis(a,!1):e.axis(a,n),t}function We(t){var e=t.chart,r=t.options,i=r.legend,n=r.seriesField;return i&&n?e.legend(n,i):i===!1&&e.legend(!1),t}function Le(t){var e=t.chart,r=t.options,i=r.label,n=r.yField,o=r.isRange,a=pt(e,"interval");if(!i)a.label(!1);else{var s=i.callback,l=Bt(i,["callback"]);a.label({fields:[n],callback:s,cfg:h({layout:l!=null&&l.position?void 0:[{type:"interval-adjust-position"},{type:"interval-hide-overlap"},{type:"adjust-color"},{type:"limit-in-plot",cfg:{action:"hide"}}]},Vt(o?h({content:function(u){var g;return(g=u[n])===null||g===void 0?void 0:g.join("-")}},l):l))})}return t}function ze(t){var e=t.chart,r=t.options,i=r.tooltip,n=r.isGroup,o=r.isStack,a=r.groupField,s=r.data,l=r.xField,u=r.yField,g=r.seriesField;if(i===!1)e.tooltip(!1);else{var v=i;if(n&&o){var c=(v==null?void 0:v.formatter)||function(d){return{name:d[g]+" - "+d[a],value:d[u]}};v=h(h({},v),{customItems:function(d){var p=[];return I(d,function(b){var m=bt(s,function(f){return Nt(f,R(b.data,[l,g]))});m.forEach(function(f){p.push(h(h(h({},b),{value:f[u],data:f,mappingData:{_origin:f}}),c(f)))})}),p}})}e.tooltip(v)}return t}function Be(t,e){e===void 0&&(e=!1);var r=t.options,i=r.seriesField;return tt(Te,z,he("columnStyle"),zt,Lt("rect"),De,Me,Re,We,ze,Wt,Rt,Le,Ge,H,U,Y(),Ae(r.yField,!e,!!i),Pe(!r.isStack),X)(t)}function Ve(t){var e=t.options,r=t.chart,i=e.geometryOption,n=i.isStack,o=i.color,a=i.seriesField,s=i.groupField,l=i.isGroup,u=["xField","yField"];if(K(i)){jt(y({},t,{options:h(h(h({},R(e,u)),i),{line:{color:i.color,style:i.lineStyle}})})),$t(y({},t,{options:h(h(h({},R(e,u)),i),{point:i.point&&h({color:o,shape:"circle"},i.point)})}));var g=[];l&&g.push({type:"dodge",dodgeBy:s||a,customOffset:0}),n&&g.push({type:"stack"}),g.length&&I(r.geometries,function(v){v.adjust(g)})}return nt(i)&&Be(y({},t,{options:h(h(h({},R(e,u)),i),{widthRatio:i.columnWidthRatio,interval:h(h({},R(i,["color"])),{style:i.columnStyle})})})),t}var dt=function(t,e){var r=e[0],i=e[1],n=t.getOptions().data,o=t.getXScale(),a=at(n);if(!(!o||!a)){var s=qt(n,o.field),l=s,u=at(l),g=Math.floor(r*(u-1)),v=Math.floor(i*(u-1));t.filter(o.field,function(c){var d=l.indexOf(c);return d>-1?ee(d,g,v):!0}),t.getRootView().render(!0)}};function Ne(t){var e,r=t.options,i=r.geometryOptions,n=i===void 0?[]:i,o=r.xField,a=r.yField,s=Yt(n,function(l){var u=l.geometry;return u===G.Line||u===void 0});return y({},{options:{geometryOptions:[],meta:(e={},e[o]={type:"cat",sync:!0,range:s?[0,1]:void 0},e),tooltip:{showMarkers:s,showCrosshairs:s,shared:!0,crosshairs:{type:"x"}},interactions:s?[{type:"legend-visible-filter"}]:[{type:"legend-visible-filter"},{type:"active-region"}],legend:{position:"top-left"}}},t,{options:{yAxis:ut(a,r.yAxis),geometryOptions:[st(o,a[0],n[0]),st(o,a[1],n[1])],annotations:ut(a,r.annotations)}})}function je(t){var e,r,i=t.chart,n=t.options,o=n.geometryOptions,a={line:0,column:1},s=[{type:(e=o[0])===null||e===void 0?void 0:e.geometry,id:C},{type:(r=o[1])===null||r===void 0?void 0:r.geometry,id:A}];return s.sort(function(l,u){return-a[l.type]+a[u.type]}).forEach(function(l){return i.createView({id:l.id})}),t}function $e(t){var e=t.chart,r=t.options,i=r.xField,n=r.yField,o=r.geometryOptions,a=r.data,s=r.tooltip,l=[h(h({},o[0]),{id:C,data:a[0],yField:n[0]}),h(h({},o[1]),{id:A,data:a[1],yField:n[1]})];return l.forEach(function(u){var g=u.id,v=u.data,c=u.yField,d=nt(u)&&u.isPercent,p=d?St(v,c,i,c):v,b=k(e,g).data(p),m=d?h({formatter:function(f){return{name:f[u.seriesField]||c,value:(Number(f[c])*100).toFixed(2)+"%"}}},s):s;Ve({chart:b,options:{xField:i,yField:c,tooltip:m,geometryOption:u}})}),t}function qe(t){var e,r=t.chart,i=t.options,n=i.geometryOptions,o=((e=r.getTheme())===null||e===void 0?void 0:e.colors10)||[],a=0;return r.once("beforepaint",function(){I(n,function(s,l){var u=k(r,l===0?C:A);if(!s.color){var g=u.getGroupScales(),v=F(g,[0,"values","length"],1),c=o.slice(a,a+v).concat(l===0?[]:o);u.geometries.forEach(function(d){s.seriesField?d.color(s.seriesField,c):d.color(c[0])}),a+=v}}),r.render(!0)}),t}function Ye(t){var e,r,i=t.chart,n=t.options,o=n.xAxis,a=n.yAxis,s=n.xField,l=n.yField;return Z((e={},e[s]=o,e[l[0]]=a[0],e))(y({},t,{chart:k(i,C)})),Z((r={},r[s]=o,r[l[1]]=a[1],r))(y({},t,{chart:k(i,A)})),t}function Ue(t){var e=t.chart,r=t.options,i=k(e,C),n=k(e,A),o=r.xField,a=r.yField,s=r.xAxis,l=r.yAxis;return e.axis(o,!1),e.axis(a[0],!1),e.axis(a[1],!1),i.axis(o,s),i.axis(a[0],ct(l[0],M.Left)),n.axis(o,!1),n.axis(a[1],ct(l[1],M.Right)),t}function He(t){var e=t.chart,r=t.options,i=r.tooltip,n=k(e,C),o=k(e,A);return e.tooltip(i),n.tooltip({shared:!0}),o.tooltip({shared:!0}),t}function Xe(t){var e=t.chart;return H(y({},t,{chart:k(e,C)})),H(y({},t,{chart:k(e,A)})),t}function Ze(t){var e=t.chart,r=t.options,i=r.annotations,n=F(i,[0]),o=F(i,[1]);return Y(n)(y({},t,{chart:k(e,C),options:{annotations:n}})),Y(o)(y({},t,{chart:k(e,A),options:{annotations:o}})),t}function Ke(t){var e=t.chart;return z(y({},t,{chart:k(e,C)})),z(y({},t,{chart:k(e,A)})),z(t),t}function Je(t){var e=t.chart;return U(y({},t,{chart:k(e,C)})),U(y({},t,{chart:k(e,A)})),t}function Qe(t){var e=t.chart,r=t.options,i=r.yAxis;return X(y({},t,{chart:k(e,C),options:{yAxis:i[0]}})),X(y({},t,{chart:k(e,A),options:{yAxis:i[1]}})),t}function tr(t){var e=t.chart,r=t.options,i=r.legend,n=r.geometryOptions,o=r.yField,a=r.data,s=k(e,C),l=k(e,A);if(i===!1)e.legend(!1);else if(J(i)&&i.custom===!0)e.legend(i);else{var u=F(n,[0,"legend"],i),g=F(n,[1,"legend"],i);e.once("beforepaint",function(){var v=a[0].length?gt({view:s,geometryOption:n[0],yField:o[0],legend:u}):[],c=a[1].length?gt({view:l,geometryOption:n[1],yField:o[1],legend:g}):[];e.legend(y({},i,{custom:!0,items:v.concat(c)}))}),n[0].seriesField&&s.legend(n[0].seriesField,u),n[1].seriesField&&l.legend(n[1].seriesField,g),e.on("legend-item:click",function(v){var c=F(v,"gEvent.delegateObject",{});if(c&&c.item){var d=c.item,p=d.value,b=d.isGeometry,m=d.viewId;if(b){var f=te(o,function(x){return x===p});if(f>-1){var w=F(k(e,m),"geometries");I(w,function(x){x.changeVisible(!c.item.unchecked)})}}else{var S=F(e.getController("legend"),"option.items",[]);I(e.views,function(x){var D=x.getGroupScales();I(D,function(O){O.values&&O.values.indexOf(p)>-1&&x.filter(O.field,function(q){var At=mt(S,function(Pt){return Pt.value===q});return!At.unchecked})}),e.render(!0)})}}})}return t}function er(t){var e=t.chart,r=t.options,i=r.slider,n=k(e,C),o=k(e,A);return i&&(n.option("slider",i),n.on("slider:valuechanged",function(a){var s=a.event,l=s.value,u=s.originValue;Ut(l,u)||dt(o,l)}),e.once("afterpaint",function(){if(!Ht(i)){var a=i.start,s=i.end;(a||s)&&dt(o,[a,s])}})),t}function rr(t){return tt(Ne,je,Ke,$e,Ye,Ue,Qe,He,Xe,Ze,Je,qe,tr,er)(t)}var ir=function(t){yt(e,t);function e(){var r=t!==null&&t.apply(this,arguments)||this;return r.type="dual-axes",r}return e.prototype.getDefaultOptions=function(){return y({},t.prototype.getDefaultOptions.call(this),{yAxis:[],syncViewPadding:!0})},e.prototype.getSchemaAdaptor=function(){return rr},e}(Xt),nr=xt({props:{data:{type:Object,default:()=>({column:[],line:[]})}},setup(t){let e;const r={data:[t.data.column,t.data.line],xField:"date",yField:["value","count"],geometryOptions:[{geometry:"column",isStack:!0,seriesField:"type"},{geometry:"line",label:{style:{fill:"#626681"}}}]};return kt(()=>{e=new ir("columnContainer",r),e.render()}),Jt(t.data,i=>{e.changeData([i.column,i.line])}),()=>W("div",{id:"columnContainer"},null)}});const or=t=>{const e={};return t.forEach(r=>{e[r.date]>=0?e[r.date]=e[r.date]+r.value:e[r.date]=r.value}),Object.entries(e).map(([r,i])=>({date:r,count:i}))},ar=t=>t.reduce((e,r)=>e+r.value,0);var Cr=xt({setup(){const t=lt(!0),e=lt({column:[],line:[]}),r=async()=>{const i=await Zt();e.value.column.splice(0,i.length,...i),e.value.line=or(e.value.column),t.value=!1};return kt(()=>{r()}),()=>W(Kt,null,{default:()=>[W(Qt,{title:`\u603B\u8BA1\u8425\u6536\uFF1A${ar([...e.value.column])}`,style:{"margin-bottom":"24px"},loading:t.value,bordered:!1,"body-style":{padding:0}},{default:()=>[W("div",{style:"min-height: 400px;margin:12px 24px"},[W(nr,{data:e.value},null)])]})]})}});export{Cr as default};
