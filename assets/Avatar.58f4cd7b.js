import{P as a,t as e,s as t,J as n,_ as s,j as r,a as o,o as c,O as i}from"./debounce.53224f53.js";import{u as l}from"./useBreakpoint.69150a26.js";import{R as u}from"./_Set.00542764.js";import{u as f}from"./useSize.a8cdded3.js";import{d as v,p,s as d,x as g,E as m,n as h,i as x}from"./vendor.6f72d5fc.js";var b={prefixCls:a.string,shape:a.oneOf(e("circle","square")).def("circle"),size:{type:[Number,String,Object],default:function(){return"default"}},src:a.string,srcset:a.string,icon:a.VNodeChild,alt:a.string,gap:a.number,draggable:a.bool,loadError:{type:Function}},y=v({name:"AAvatar",inheritAttrs:!1,props:b,slots:["icon"],setup:function(a,e){var v=e.slots,b=e.attrs,y=p(!0),j=p(!1),z=p(1),S=p(null),A=p(null),E=t("avatar",a).prefixCls,C=f(),H=l(),O=d((function(){if("object"===c(a.size)){var e=i.find((function(a){return H.value[a]}));return a.size[e]}})),W=function(){if(S.value&&A.value){var e=S.value.offsetWidth,t=A.value.offsetWidth;if(0!==e&&0!==t){var n=a.gap,s=void 0===n?4:n;2*s<t&&(z.value=t-2*s<e?(t-2*s)/e:1)}}},k=function(){var e=a.loadError;!1!==(null==e?void 0:e())&&(y.value=!1)};return g((function(){return a.src}),(function(){h((function(){y.value=!0,z.value=1}))})),g((function(){return a.gap}),(function(){h((function(){W()}))})),m((function(){h((function(){W(),j.value=!0}))})),function(){var e,t,c,i,l=a.shape,f=a.size,p=a.src,d=a.alt,g=a.srcset,m=a.draggable,h=n(v,a,"icon"),H=E.value,w="default"===f?C.value:f,N=(s(e={},"".concat(b.class),!!b.class),s(e,H,!0),s(e,"".concat(H,"-lg"),"large"===w),s(e,"".concat(H,"-sm"),"small"===w),s(e,"".concat(H,"-").concat(l),l),s(e,"".concat(H,"-image"),p&&y.value),s(e,"".concat(H,"-icon"),h),e),R="number"==typeof w?{width:"".concat(w,"px"),height:"".concat(w,"px"),lineHeight:"".concat(w,"px"),fontSize:h?"".concat(w/2,"px"):"18px"}:{},T=null===(t=v.default)||void 0===t?void 0:t.call(v);if(p&&y.value)c=x("img",{draggable:m,src:p,srcset:g,onError:k,alt:d},null);else if(h)c=h;else if(j.value||1!==z.value){var _="scale(".concat(z.value,") translateX(-50%)"),q={msTransform:_,WebkitTransform:_,transform:_},B="number"==typeof w?{lineHeight:"".concat(w,"px")}:{};c=x(u,{onResize:W},{default:function(){return[x("span",{class:"".concat(H,"-string"),ref:S,style:o(o({},B),q)},[T])]}})}else c=x("span",{class:"".concat(H,"-string"),ref:S,style:{opacity:0}},[T]);return x("span",r(r({},b),{},{ref:A,class:N,style:o(o(o({},R),(i=!!h,O.value?{width:"".concat(O.value,"px"),height:"".concat(O.value,"px"),lineHeight:"".concat(O.value,"px"),fontSize:"".concat(i?O.value/2:18,"px")}:{})),b.style)}),[c])}}});export{y as A,b as a};
