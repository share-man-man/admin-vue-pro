import{P as a,t as e,k as t,G as n,d as s,j as r,_ as c,b as o,O as i}from"./debounce.67102cb7.js";import{u as l}from"./useBreakpoint.b2479951.js";import{R as u}from"./_Set.ca07d085.js";import{u as f}from"./useSize.851ed957.js";import{d as v,l as p,p as d,w as g,E as m,z as b,i as h}from"./vendor.1bd2b8e6.js";var x={prefixCls:a.string,shape:a.oneOf(e("circle","square")).def("circle"),size:{type:[Number,String,Object],default:function(){return"default"}},src:a.string,srcset:a.string,icon:a.VNodeChild,alt:a.string,gap:a.number,draggable:a.bool,loadError:{type:Function}},y=v({name:"AAvatar",inheritAttrs:!1,props:x,slots:["icon"],setup:function(a,e){var v=e.slots,x=e.attrs,y=p(!0),z=p(!1),j=p(1),S=p(null),A=p(null),E=t("avatar",a).prefixCls,k=f(),w=l(),C=d((function(){if("object"===o(a.size)){var e=i.find((function(a){return w.value[a]}));return a.size[e]}})),H=function(){if(S.value&&A.value){var e=S.value.offsetWidth,t=A.value.offsetWidth;if(0!==e&&0!==t){var n=a.gap,s=void 0===n?4:n;2*s<t&&(j.value=t-2*s<e?(t-2*s)/e:1)}}},O=function(){var e=a.loadError;!1!==(null==e?void 0:e())&&(y.value=!1)};return g((function(){return a.src}),(function(){b((function(){y.value=!0,j.value=1}))})),g((function(){return a.gap}),(function(){b((function(){H()}))})),m((function(){b((function(){H(),z.value=!0}))})),function(){var e,t,o,i,l=a.shape,f=a.size,p=a.src,d=a.alt,g=a.srcset,m=a.draggable,b=n(v,a,"icon"),w=E.value,W="default"===f?k.value:f,N=(s(e={},"".concat(x.class),!!x.class),s(e,w,!0),s(e,"".concat(w,"-lg"),"large"===W),s(e,"".concat(w,"-sm"),"small"===W),s(e,"".concat(w,"-").concat(l),l),s(e,"".concat(w,"-image"),p&&y.value),s(e,"".concat(w,"-icon"),b),e),R="number"==typeof W?{width:"".concat(W,"px"),height:"".concat(W,"px"),lineHeight:"".concat(W,"px"),fontSize:b?"".concat(W/2,"px"):"18px"}:{},T=null===(t=v.default)||void 0===t?void 0:t.call(v);if(p&&y.value)o=h("img",{draggable:m,src:p,srcset:g,onError:O,alt:d},null);else if(b)o=b;else if(z.value||1!==j.value){var _="scale(".concat(j.value,") translateX(-50%)"),q={msTransform:_,WebkitTransform:_,transform:_},B="number"==typeof W?{lineHeight:"".concat(W,"px")}:{};o=h(u,{onResize:H},{default:function(){return[h("span",{class:"".concat(w,"-string"),ref:S,style:c(c({},B),q)},[T])]}})}else o=h("span",{class:"".concat(w,"-string"),ref:S,style:{opacity:0}},[T]);return h("span",r(r({},x),{},{ref:A,class:N,style:c(c(c({},R),(i=!!b,C.value?{width:"".concat(C.value,"px"),height:"".concat(C.value,"px"),lineHeight:"".concat(C.value,"px"),fontSize:"".concat(i?C.value/2:18,"px")}:{})),x.style)}),[o])}}});export{y as A,x as a};
