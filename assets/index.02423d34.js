import{x as t,y as e,z as i,d as r,U as n,_ as o,B as a,o as s,C as l,D as u,a as c,g,E as d,F as h,j as f,G as m,H as p,I as v,J as y,u as b,n as x,A as k,q as w,K as F,f as S,e as C,c as E,i as O,L as j,M,N as P,t as z,O as A,s as I,k as R,m as G,Q as B,R as W,h as L,p as D,S as _,V as T,W as N,X as V,Y as q,P as H,Z as U}from"./workspace.fdcb948c.js";import{a as X}from"./Content.f5575f33.js";import{d as J,E as K,w as Q,i as Y,l as Z}from"./vendor.13fa0854.js";import{I as $}from"./Input.7913cdd1.js";import{C as tt}from"./Card.4aabf5b7.js";import"./oauth.e9db2a4e.js";import"./debounce.7c4b284f.js";import"./index.fa6786fd.js";import"./createChainedFunction.2d5d7d53.js";import"./ExclamationCircleFilled.5fde2de7.js";import"./CloseCircleFilled.b1621eba.js";import"./LoadingOutlined.13f3bbc7.js";import"./CloseCircleOutlined.d00e7753.js";import"./InfoCircleOutlined.9aac814c.js";import"./code.aa7872b2.js";import"./index.05878a6c.js";import"./antInputDirective.dcf4b893.js";import"./index.9563d230.js";import"./index.cc37a535.js";import"./tabs.b235e8bb.js";import"./LeftOutlined.55549e0c.js";import"./Col.74b7851b.js";function et(t,e){return t.views.find((function(t){return t.id===e}))}function it(t){return"number"==typeof t&&!isNaN(t)}function rt(){return"object"==typeof window?null===window||void 0===window?void 0:window.devicePixelRatio:2}function nt(t,e){void 0===e&&(e=t);var i=document.createElement("canvas"),r=rt();return i.width=t*r,i.height=e*r,i.style.width=t+"px",i.style.height=e+"px",i.getContext("2d").scale(r,r),i}function ot(t,e,i,r){void 0===r&&(r=i);var n=e.backgroundColor,o=e.opacity;t.globalAlpha=o,t.fillStyle=n,t.beginPath(),t.fillRect(0,0,i,r),t.closePath()}function at(t,e,i){var r=t+e;return i?2*r:r}function st(t,e){return e?[[t*(1/4),t*(1/4)],[t*(3/4),t*(3/4)]]:[[.5*t,.5*t]]}function lt(t,e){var i=e*Math.PI/180;return{a:Math.cos(i)*(1/t),b:Math.sin(i)*(1/t),c:-Math.sin(i)*(1/t),d:Math.cos(i)*(1/t),e:0,f:0}}var ut={size:6,padding:2,backgroundColor:"transparent",opacity:1,rotation:0,fill:"#fff",fillOpacity:.5,stroke:"transparent",lineWidth:0,isStagger:!0};function ct(t,e,i,r){var n=e.size,o=e.fill,a=e.lineWidth,s=e.stroke,l=e.fillOpacity;t.beginPath(),t.globalAlpha=l,t.fillStyle=o,t.strokeStyle=s,t.lineWidth=a,t.arc(i,r,n/2,0,2*Math.PI,!1),t.fill(),a&&t.stroke(),t.closePath()}var gt={rotation:45,spacing:5,opacity:1,backgroundColor:"transparent",strokeOpacity:.5,stroke:"#fff",lineWidth:2};function dt(t){var e=r({},gt,t),i=e.spacing,n=e.rotation,o=e.lineWidth,a=i+o||1,s=i+o||1,l="\n            M 0 0 L "+a+" 0\n            M 0 "+s+" L "+a+" "+s+"\n            ",u=nt(a,s),c=u.getContext("2d");ot(c,e,a,s),function(t,e,i){var r=e.stroke,n=e.lineWidth,o=e.strokeOpacity,a=new Path2D(i);t.globalAlpha=o,t.lineCap="square",t.strokeStyle=n?r:"transparent",t.lineWidth=n,t.stroke(a)}(c,e,l);var g=c.createPattern(u,"repeat");if(g){var d=lt(rt(),n);g.setTransform(d)}return g}var ht,ft,mt,pt,vt={size:6,padding:1,isStagger:!0,backgroundColor:"transparent",opacity:1,rotation:0,fill:"#fff",fillOpacity:.5,stroke:"transparent",lineWidth:0};function yt(t,e,i,r){var n=e.stroke,o=e.size,a=e.fill,s=e.lineWidth,l=e.fillOpacity;t.globalAlpha=l,t.strokeStyle=n,t.lineWidth=s,t.fillStyle=a,t.strokeRect(i-o/2,r-o/2,o,o),t.fillRect(i-o/2,r-o/2,o,o)}function bt(t){var e,i=t.type,n=t.cfg;switch(i){case"dot":e=function(t){var e=r({},ut,t),i=e.size,n=e.padding,o=e.isStagger,a=e.rotation,s=at(i,n,o),l=st(s,o),u=nt(s,s),c=u.getContext("2d");ot(c,e,s);for(var g=0,d=l;g<d.length;g++){var h=d[g];ct(c,e,h[0],h[1])}var f=c.createPattern(u,"repeat");if(f){var m=lt(rt(),a);f.setTransform(m)}return f}(n);break;case"line":e=dt(n);break;case"square":e=function(t){var e=r({},vt,t),i=e.size,n=e.padding,o=e.isStagger,a=e.rotation,s=at(i,n,o),l=st(s,o),u=nt(s,s),c=u.getContext("2d");ot(c,e,s);for(var g=0,d=l;g<d.length;g++){var h=d[g];yt(c,e,h[0],h[1])}var f=c.createPattern(u,"repeat");if(f){var m=lt(rt(),a);f.setTransform(m)}return f}(n)}return e}function xt(t){var e=t.options,i=e.xField,n=e.yField,a=e.interval,d=e.seriesField,h=e.tooltip,f=e.minColumnWidth,m=e.maxColumnWidth,p=e.columnBackground,v=e.dodgePadding,y=e.intervalPadding,b=c(h,[i,n,d]),x=b.fields,k=b.formatter,w=(a?g(r({},t,{options:{type:"interval",colorField:d,tooltipFields:x,mapping:o({tooltip:k},a),args:{dodgePadding:v,intervalPadding:y,minColumnWidth:f,maxColumnWidth:m,background:p}}})):t).ext;return function(t){var e=t.chart,i=t.options,n=t.ext,o=i.seriesField,a=i.isGroup,c=i.isStack,g=i.marginRatio,d=i.widthRatio,h=i.groupField,f=i.theme,m=[];return o&&(a&&m.push({type:"dodge",dodgeBy:h||o,marginRatio:g}),c&&m.push({type:"stack",marginRatio:g})),m.length&&(null==n?void 0:n.geometry)&&(null==n?void 0:n.geometry).adjust(m),s(d)||e.theme(r({},l(f)?f:u(f),{columnWidthRatio:d})),t}(o(o({},t),{ext:w}))}function kt(t,e,i,r){var n=h(t,(function(t,r){var n=r[i],o=t.has(n)?t.get(n):0,a=r[e];return o=it(a)?o+a:o,t.set(n,o),t}),new Map);return d(t,(function(t){var a,s=t[e],l=t[i],u=it(s)?s/n.get(l):0;return o(o({},t),((a={})[r]=u,a))}))}(ft=ht||(ht={})).Left="Left",ft.Right="Right",(pt=mt||(mt={})).Line="line",pt.Column="column";var wt={nice:!0,label:{autoHide:!0,autoRotate:!1}},Ft=o(o({},wt),{position:"left"}),St=o(o({},wt),{position:"right",grid:null});function Ct(e){return t(e,"geometry")===mt.Line}function Et(e){return t(e,"geometry")===mt.Column}function Ot(t,e,i){return Et(i)?r({},{geometry:mt.Column,label:i.label&&i.isRange?{content:function(t){var i;return null===(i=t[e])||void 0===i?void 0:i.join("-")}}:void 0},i):o({geometry:mt.Line},i)}function jt(e,r){var n=e[0],o=e[1];return i(r)?[r[0],r[1]]:[t(r,n),t(r,o)]}function Mt(t,e){return e===ht.Left?!1!==t&&r({},Ft,t):e===ht.Right?!1!==t&&r({},St,t):t}function Pt(e){var i=e.view,o=e.geometryOption,a=e.yField,s=e.legend,l=t(s,"marker"),u=f(i,Ct(o)?"line":"interval");if(!o.seriesField){var c=t(i,"options.scales."+a+".alias")||a,g=u.getAttribute("color"),d=n.getMappingValue(g,c,g.values[0]);return[{value:a,name:c,marker:(m(l)?l:!p(l)&&r({},{style:{stroke:d,fill:d}},l))||(Ct(o)?{symbol:function(t,e,i){return[["M",t-i,e],["L",t+i,e]]},style:{lineWidth:2,r:6,stroke:d}}:{symbol:"square",style:{fill:d}}),isGeometry:!0,viewId:i.id}]}var v=u.getGroupAttributes();return h(v,(function(t,e){var r=n.getLegendItems(i,u,e,i.getTheme(),l);return t.concat(r)}),[])}function zt(t,i){return e(t)&&e(i)?t===i?"100%":0===t?"∞":0===i?"-∞":(100*i/t).toFixed(2)+"%":"-"}function At(t,e){return r({size:e?32:80,spacing:e?8:12,offset:e?32:0,arrow:!1!==t.arrow&&{headSize:12,style:{fill:"rgba(0, 0, 0, 0.05)"}},text:!1!==t.text&&{style:{fontSize:12,fill:"rgba(0, 0, 0, 0.85)",textAlign:"center",textBaseline:"middle"},formatter:zt}},t)}function It(t,e){return d(e.getModel().points,(function(e){return t.convertPoint(e)}))}function Rt(t,e,i){!function(t,e,i){var r=t.view,n=t.geometry,a=t.group,s=t.options,l=t.horizontal,u=s.offset,c=s.size,g=s.arrow,d=r.getCoordinate(),h=It(d,e)[l?3:0],f=It(d,i)[l?0:3],m=f.y-h.y,p=f.x-h.x;if("boolean"!=typeof g){var v,y=g.headSize,b=s.spacing;l?(p-y)/2<b?(b=Math.max(1,(p-y)/2),v=[[h.x+b,h.y-u],[h.x+b,h.y-u-c],[f.x-b,f.y-u-c/2]]):v=[[h.x+b,h.y-u],[h.x+b,h.y-u-c],[f.x-b-y,f.y-u-c],[f.x-b,f.y-u-c/2],[f.x-b-y,f.y-u]]:(m-y)/2<b?(b=Math.max(1,(m-y)/2),v=[[h.x+u,h.y+b],[h.x+u+c,h.y+b],[f.x+u+c/2,f.y-b]]):v=[[h.x+u,h.y+b],[h.x+u+c,h.y+b],[f.x+u+c,f.y-b-y],[f.x+u+c/2,f.y-b],[f.x+u,f.y-b-y]],a.addShape("polygon",{id:r.id+"-conversion-tag-arrow-"+n.getElementId(e.getModel().mappingData),name:"conversion-tag-arrow",origin:{element:e,nextElement:i},attrs:o(o({},g.style||{}),{points:v})})}}(t,e,i),function(t,e,i){var r,n,a,s=t.view,l=t.geometry,u=t.group,c=t.options,g=t.field,d=t.horizontal,h=c.offset,f=c.size;if("boolean"!=typeof c.text){var m=s.getCoordinate(),p=(null===(r=c.text)||void 0===r?void 0:r.formatter)&&(null===(n=c.text)||void 0===n?void 0:n.formatter(e.getData()[g],i.getData()[g])),v=It(m,e)[d?3:0],y=It(m,i)[d?0:3],b=u.addShape("text",{id:s.id+"-conversion-tag-text-"+l.getElementId(e.getModel().mappingData),name:"conversion-tag-text",origin:{element:e,nextElement:i},attrs:o(o({},(null===(a=c.text)||void 0===a?void 0:a.style)||{}),{text:p,x:d?(v.x+y.x)/2:v.x+h+f/2,y:d?v.y-h-f/2:(v.y+y.y)/2})});if(d){var x=y.x-v.x,k=b.getBBox().width;if(k>x){var w=k/p.length,F=Math.max(1,Math.ceil(x/w)-1),S=p.slice(0,F)+"...";b.attr("text",S)}}}}(t,e,i)}var Gt={hover:"__interval-connected-area-hover__",click:"__interval-connected-area-click__"},Bt=function(t,e){return"hover"===t?[{trigger:"interval:mouseenter",action:["element-highlight-by-color:highlight","element-link-by-color:link"],arg:[null,{style:e}]}]:[{trigger:"interval:click",action:["element-highlight-by-color:clear","element-highlight-by-color:highlight","element-link-by-color:clear","element-link-by-color:unlink","element-link-by-color:link"],arg:[null,null,null,null,{style:e}]}]};b(Gt.hover,{start:Bt(Gt.hover),end:[{trigger:"interval:mouseleave",action:["element-highlight-by-color:reset","element-link-by-color:unlink"]}]}),b(Gt.click,{start:Bt(Gt.click),end:[{trigger:"document:mousedown",action:["element-highlight-by-color:clear","element-link-by-color:clear"]}]});var Wt={padding:[8,10],text:"reset",textStyle:{default:{x:0,y:0,fontSize:12,fill:"#333333",cursor:"pointer"}},buttonStyle:{default:{fill:"#f7f7f7",stroke:"#cccccc",cursor:"pointer"},active:{fill:"#e6e6e6"}}};function Lt(t){return t.isInPlot()}function Dt(t,e,i){var r=e||"rect";switch(t){case"brush":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:Lt,action:["brush:start",r+"-mask:start",r+"-mask:show"],arg:[null,{maskStyle:null==i?void 0:i.style}]}],processing:[{trigger:"mousemove",isEnable:Lt,action:[r+"-mask:resize"]}],end:[{trigger:"mouseup",isEnable:Lt,action:["brush:filter","brush:end",r+"-mask:end",r+"-mask:hide","brush-reset-button:show"]}],rollback:[{trigger:"brush-reset-button:click",action:["brush:reset","brush-reset-button:hide","cursor:crosshair"]}]};case"brush-highlight":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"mask:mouseenter",action:"cursor:move"},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:function(t){return!t.isInShape("mask")},action:[r+"-mask:start",r+"-mask:show"],arg:[{maskStyle:null==i?void 0:i.style}]},{trigger:"mask:dragstart",action:[r+"-mask:moveStart"]}],processing:[{trigger:"plot:mousemove",action:[r+"-mask:resize"]},{trigger:"mask:drag",action:[r+"-mask:move"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:[r+"-mask:end"]},{trigger:"mask:dragend",action:[r+"-mask:moveEnd"]},{trigger:"document:mouseup",isEnable:function(t){return!t.isInPlot()},action:["element-range-highlight:clear",r+"-mask:end",r+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear",r+"-mask:hide"]}]};case"brush-x":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:Lt,action:["brush-x:start",r+"-mask:start",r+"-mask:show"],arg:[null,{maskStyle:null==i?void 0:i.style}]}],processing:[{trigger:"mousemove",isEnable:Lt,action:[r+"-mask:resize"]}],end:[{trigger:"mouseup",isEnable:Lt,action:["brush-x:filter","brush-x:end",r+"-mask:end",r+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["brush-x:reset"]}]};case"brush-x-highlight":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"mask:mouseenter",action:"cursor:move"},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:function(t){return!t.isInShape("mask")},action:[r+"-mask:start",r+"-mask:show"],arg:[{maskStyle:null==i?void 0:i.style}]},{trigger:"mask:dragstart",action:[r+"-mask:moveStart"]}],processing:[{trigger:"plot:mousemove",action:[r+"-mask:resize"]},{trigger:"mask:drag",action:[r+"-mask:move"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:[r+"-mask:end"]},{trigger:"mask:dragend",action:[r+"-mask:moveEnd"]},{trigger:"document:mouseup",isEnable:function(t){return!t.isInPlot()},action:["element-range-highlight:clear",r+"-mask:end",r+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear",r+"-mask:hide"]}]};case"brush-y":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"plot:mouseleave",action:"cursor:default"}],start:[{trigger:"mousedown",isEnable:Lt,action:["brush-y:start",r+"-mask:start",r+"-mask:show"],arg:[null,{maskStyle:null==i?void 0:i.style}]}],processing:[{trigger:"mousemove",isEnable:Lt,action:[r+"-mask:resize"]}],end:[{trigger:"mouseup",isEnable:Lt,action:["brush-y:filter","brush-y:end",r+"-mask:end",r+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["brush-y:reset"]}]};case"brush-y-highlight":return{showEnable:[{trigger:"plot:mouseenter",action:"cursor:crosshair"},{trigger:"mask:mouseenter",action:"cursor:move"},{trigger:"plot:mouseleave",action:"cursor:default"},{trigger:"mask:mouseleave",action:"cursor:crosshair"}],start:[{trigger:"plot:mousedown",isEnable:function(t){return!t.isInShape("mask")},action:[r+"-mask:start",r+"-mask:show"],arg:[{maskStyle:null==i?void 0:i.style}]},{trigger:"mask:dragstart",action:[r+"-mask:moveStart"]}],processing:[{trigger:"plot:mousemove",action:[r+"-mask:resize"]},{trigger:"mask:drag",action:[r+"-mask:move"]},{trigger:"mask:change",action:["element-range-highlight:highlight"]}],end:[{trigger:"plot:mouseup",action:[r+"-mask:end"]},{trigger:"mask:dragend",action:[r+"-mask:moveEnd"]},{trigger:"document:mouseup",isEnable:function(t){return!t.isInPlot()},action:["element-range-highlight:clear",r+"-mask:end",r+"-mask:hide"]}],rollback:[{trigger:"dblclick",action:["element-range-highlight:clear",r+"-mask:hide"]}]};default:return{}}}w("brush-reset-button",function(a){function s(){var t=null!==a&&a.apply(this,arguments)||this;return t.buttonGroup=null,t.buttonCfg=o({name:"button"},Wt),t}return x(s,a),s.prototype.getButtonCfg=function(){var e=this.context.view,i=t(e,["interactions","filter-action","cfg","buttonConfig"]);return r(this.buttonCfg,i,this.cfg)},s.prototype.drawButton=function(){var t=this.getButtonCfg(),e=this.context.view.foregroundGroup.addGroup({name:t.name}),i=this.drawText(e);this.drawBackground(e,i.getBBox()),this.buttonGroup=e},s.prototype.drawText=function(t){var e,i=this.getButtonCfg();return t.addShape({type:"text",name:"button-text",attrs:o({text:i.text},null===(e=i.textStyle)||void 0===e?void 0:e.default)})},s.prototype.drawBackground=function(t,r){var n,a=this.getButtonCfg(),s=function(t){if(e(t))return[t,t,t,t];if(i(t)){var r=t.length;if(1===r)return[t[0],t[0],t[0],t[0]];if(2===r)return[t[0],t[1],t[0],t[1]];if(3===r)return[t[0],t[1],t[2],t[1]];if(4===r)return t}return[0,0,0,0]}(a.padding),l=t.addShape({type:"rect",name:"button-rect",attrs:o({x:r.x-s[3],y:r.y-s[0],width:r.width+s[1]+s[3],height:r.height+s[0]+s[2]},null===(n=a.buttonStyle)||void 0===n?void 0:n.default)});return l.toBack(),t.on("mouseenter",(function(){var t;l.attr(null===(t=a.buttonStyle)||void 0===t?void 0:t.active)})),t.on("mouseleave",(function(){var t;l.attr(null===(t=a.buttonStyle)||void 0===t?void 0:t.default)})),l},s.prototype.resetPosition=function(){var t=this.context.view.getCoordinate().convert({x:1,y:1}),e=this.buttonGroup,i=e.getBBox(),r=n.transform(null,[["t",t.x-i.width-10,t.y+i.height+5]]);e.setMatrix(r)},s.prototype.show=function(){this.buttonGroup||this.drawButton(),this.resetPosition(),this.buttonGroup.show()},s.prototype.hide=function(){this.buttonGroup&&this.buttonGroup.hide()},s.prototype.destroy=function(){var t=this.buttonGroup;t&&t.remove(),a.prototype.destroy.call(this)},s}(k),{name:"brush-reset-button"}),b("filter-action",{}),b("brush",Dt("brush")),b("brush-highlight",Dt("brush-highlight")),b("brush-x",Dt("brush-x","x-rect")),b("brush-y",Dt("brush-y","y-rect")),b("brush-x-highlight",Dt("brush-x-highlight","x-rect")),b("brush-y-highlight",Dt("brush-y-highlight","y-rect"));var _t=["brush","brush-x","brush-y","brush-highlight","brush-x-highlight","brush-y-highlight"];function Tt(t){var e=t.options,i=e.brush,n=F(e.interactions||[],(function(t){return-1===_t.indexOf(t.type)}));return(null==i?void 0:i.enabled)&&(_t.forEach((function(t){var e,r=!1;switch(i.type){case"x-rect":r=t===("highlight"===i.action?"brush-x-highlight":"brush-x");break;case"y-rect":r=t===("highlight"===i.action?"brush-y-highlight":"brush-y");break;default:r=t===("highlight"===i.action?"brush-highlight":"brush")}var o={type:t,enable:r};((null===(e=i.mask)||void 0===e?void 0:e.style)||i.type)&&(o.cfg=Dt(t,i.type,i.mask)),n.push(o)})),"highlight"!==(null==i?void 0:i.action)&&n.push({type:"filter-action",cfg:{buttonConfig:i.button}})),r({},t,{options:{interactions:n}})}function Nt(t){var e=t.options,i=e.legend,r=e.seriesField,n=e.isStack;return r?!1!==i&&(i=o({position:n?"right-top":"top-left"},i)):i=!1,t.options.legend=i,t}function Vt(t){var e=t.chart,i=t.options,n=i.data,a=i.columnStyle,s=i.color,l=i.columnWidthRatio,u=i.isPercent,c=i.isGroup,g=i.isStack,f=i.xField,m=i.yField,p=i.seriesField,v=i.groupField,y=i.tooltip,b=u&&c&&g?function(t,e,i,r){var n=h(t,(function(t,r){var n=h(i,(function(t,e){return""+t+r[e]}),""),o=t.has(n)?t.get(n):0,a=r[e];return o=it(a)?o+a:o,t.set(n,o),t}),new Map);return d(t,(function(t){var a,s=t[e],l=h(i,(function(e,i){return""+e+t[i]}),""),u=it(s)?s/n.get(l):0;return o(o({},t),((a={})[r]=u,a))}))}(n,m,[f,v],m):function(t,e,i,r,n){return n?kt(t,e,i,r):t}(n,m,f,m,u),x=[];g&&p&&!c?b.forEach((function(t){var e=x.find((function(e){return e[f]===t[f]&&e[p]===t[p]}));e?e[m]+=t[m]||0:x.push(o({},t))})):x=b,e.data(x);var k=u?o({formatter:function(t){return{name:c&&g?t[p]+" - "+t[v]:t[p]||t[f],value:(100*Number(t[m])).toFixed(2)+"%"}}},y):y,w=r({},t,{options:{data:x,widthRatio:l,tooltip:k,interval:{style:a,color:s}}});return xt(w),w}function qt(i){var r,n,a=i.options,s=a.xAxis,l=a.yAxis,u=a.xField,c=a.yField,g=a.data,d=a.isPercent?{max:1,min:0,minLimit:0,maxLimit:1}:{};return S(I(((r={})[u]=s,r[c]=l,r),((n={})[u]={type:"cat"},n[c]=o(o({},function(i,r){var n=i.filter((function(i){var n=t(i,[r]);return e(n)&&!isNaN(n)})),o=n.every((function(e){return t(e,[r])>=0})),a=n.every((function(e){return t(e,[r])<=0}));return o?{min:0}:a?{max:0}:{}}(g,c)),d),n)))(i)}function Ht(t){var e=t.chart,i=t.options,r=i.xAxis,n=i.yAxis,o=i.xField,a=i.yField;return!1===r?e.axis(o,!1):e.axis(o,r),!1===n?e.axis(a,!1):e.axis(a,n),t}function Ut(t){var e=t.chart,i=t.options,r=i.legend,n=i.seriesField;return r&&n?e.legend(n,r):!1===r&&e.legend(!1),t}function Xt(t){var e=t.chart,i=t.options,r=i.label,n=i.yField,a=i.isRange,s=f(e,"interval");if(r){var l=r.callback,u=R(r,["callback"]);s.label({fields:[n],callback:l,cfg:o({layout:(null==u?void 0:u.position)?void 0:[{type:"interval-adjust-position"},{type:"interval-hide-overlap"},{type:"adjust-color"},{type:"limit-in-plot",cfg:{action:"hide"}}]},G(a?o({content:function(t){var e;return null===(e=t[n])||void 0===e?void 0:e.join("-")}},u):u))})}else s.label(!1);return t}function Jt(t){var e=t.chart,i=t.options,r=i.tooltip,n=i.isGroup,a=i.isStack,s=i.groupField,l=i.data,u=i.xField,c=i.yField,g=i.seriesField;if(!1===r)e.tooltip(!1);else{var d=r;if(n&&a){var h=(null==d?void 0:d.formatter)||function(t){return{name:t[g]+" - "+t[s],value:t[c]}};d=o(o({},d),{customItems:function(t){var e=[];return y(t,(function(t){F(l,(function(e){return B(e,W(t.data,[u,g]))})).forEach((function(i){e.push(o(o(o({},t),{value:i[c],data:i,mappingData:{_origin:i}}),h(i)))}))})),e}})}e.tooltip(d)}return t}function Kt(e,i){void 0===i&&(i=!1);var s,c,g,d,h=e.options,f=h.seriesField;return S(Nt,z,function(e){var i=this;return function(s){var l,u=s.options,c=s.chart,g=u.pattern;return g?r({},s,{options:(l={},l[e]=function(s){for(var l,d,h,f=[],m=1;m<arguments.length;m++)f[m-1]=arguments[m];var p=c.getTheme().defaultColor,v=p,y=null===(d=null===(l=c.geometries)||void 0===l?void 0:l[0])||void 0===d?void 0:d.getAttribute("color");if(y){var b=y.getFields()[0],x=t(s,b);v=n.getMappingValue(y,x,(null===(h=y.values)||void 0===h?void 0:h[0])||p)}var k=g;"function"==typeof g&&(k=g.call(i,s,v)),k instanceof CanvasPattern==0&&(k=bt(r({},{cfg:{backgroundColor:v}},k)));var w=u[e];return o(o({},"function"==typeof w?w.call.apply(w,a([i,s],f)):w||{}),{fill:k||v})},l)}):s}}("columnStyle"),P,Vt,qt,Ht,Ut,Jt,M,j,Xt,Tt,O,E,C(),(c=h.yField,void 0===(g=!i)&&(g=!0),void 0===(d=!!f)&&(d=!1),function(t){var e=t.options,i=t.chart,n=e.conversionTag,o=e.theme;return n&&!d&&(i.theme(r({},l(o)?o:u(o),{columnWidthRatio:1/3})),i.annotation().shape({render:function(t,e){var r=t.addGroup({id:i.id+"-conversion-tag-group",name:"conversion-tag-group"}),o=v(i.geometries,(function(t){return"interval"===t.type})),a={view:e,geometry:o,group:r,field:c,horizontal:g,options:At(n,g)},s=g?o.elements:o.elements.slice().reverse();y(s,(function(t,e){e>0&&Rt(a,s[e-1],t)}))}})),t}),(void 0===(s=!h.isStack)&&(s=!1),function(t){var e=t.chart,i=t.options.connectedArea,r=function(){e.removeInteraction(Gt.hover),e.removeInteraction(Gt.click)};if(!s&&i){var n=i.trigger||"hover";r(),e.interaction(Gt[n],{start:Bt(n,i.style)})}else r();return t}),A)(e)}var Qt=function(t,e){var i=e[0],r=e[1],n=t.getOptions().data,o=t.getXScale(),a=_(n);if(o&&a){var s=T(n,o.field),l=_(s),u=Math.floor(i*(l-1)),c=Math.floor(r*(l-1));t.filter(o.field,(function(t){var e=s.indexOf(t);return!(e>-1)||function(t,e,i){var r=Math.min(e,i),n=Math.max(e,i);return t>=r&&t<=n}(e,u,c)})),t.render(!0)}};function Yt(t){var e,i=t.options,n=i.geometryOptions,o=void 0===n?[]:n,a=i.xField,s=i.yField,l=N(o,(function(t){var e=t.geometry;return e===mt.Line||void 0===e}));return r({},{options:{geometryOptions:[],meta:(e={},e[a]={type:"cat",sync:!0,range:l?[0,1]:void 0},e),tooltip:{showMarkers:l,showCrosshairs:l,shared:!0,crosshairs:{type:"x"}},interactions:l?[{type:"legend-visible-filter"}]:[{type:"legend-visible-filter"},{type:"active-region"}],legend:{position:"top-left"}}},t,{options:{yAxis:jt(s,i.yAxis),geometryOptions:[Ot(0,s[0],o[0]),Ot(0,s[1],o[1])],annotations:jt(s,i.annotations)}})}function Zt(t){var e,i,r=t.chart,n=t.options.geometryOptions,o={line:0,column:1};return[{type:null===(e=n[0])||void 0===e?void 0:e.geometry,id:"left-axes-view"},{type:null===(i=n[1])||void 0===i?void 0:i.geometry,id:"right-axes-view"}].sort((function(t,e){return-o[t.type]+o[e.type]})).forEach((function(t){return r.createView({id:t.id})})),t}function $t(t){var e=t.chart,i=t.options,n=i.xField,a=i.yField,s=i.geometryOptions,l=i.data,u=i.tooltip;return[o(o({},s[0]),{id:"left-axes-view",data:l[0],yField:a[0]}),o(o({},s[1]),{id:"right-axes-view",data:l[1],yField:a[1]})].forEach((function(t){var i=t.id,a=t.data,s=t.yField,l=Et(t)&&t.isPercent,c=l?kt(a,s,n,s):a,g=et(e,i).data(c),d=l?o({formatter:function(e){return{name:e[t.seriesField]||s,value:(100*Number(e[s])).toFixed(2)+"%"}}},u):u;!function(t){var e=t.options,i=t.chart,n=e.geometryOption,a=n.isStack,s=n.color,l=n.seriesField,u=n.groupField,c=n.isGroup,g=["xField","yField"];if(Ct(n)){L(r({},t,{options:o(o(o({},W(e,g)),n),{line:{color:n.color,style:n.lineStyle}})})),D(r({},t,{options:o(o(o({},W(e,g)),n),{point:n.point&&o({color:s,shape:"circle"},n.point)})}));var d=[];c&&d.push({type:"dodge",dodgeBy:u||l,customOffset:0}),a&&d.push({type:"stack"}),d.length&&y(i.geometries,(function(t){t.adjust(d)}))}Et(n)&&Kt(r({},t,{options:o(o(o({},W(e,g)),n),{widthRatio:n.columnWidthRatio,interval:o(o({},W(n,["color"])),{style:n.columnStyle})})}))}({chart:g,options:{xField:n,yField:s,tooltip:d,geometryOption:t}})})),t}function te(e){var i,r=e.chart,n=e.options.geometryOptions,o=(null===(i=r.getTheme())||void 0===i?void 0:i.colors10)||[],a=0;return r.once("beforepaint",(function(){y(n,(function(e,i){var n=et(r,0===i?"left-axes-view":"right-axes-view");if(!e.color){var s=n.getGroupScales(),l=t(s,[0,"values","length"],1),u=o.slice(a,a+l).concat(0===i?[]:o);n.geometries.forEach((function(t){e.seriesField?t.color(e.seriesField,u):t.color(u[0])})),a+=l}})),r.render(!0)})),e}function ee(t){var e,i,n=t.chart,o=t.options,a=o.xAxis,s=o.yAxis,l=o.xField,u=o.yField;return I(((e={})[l]=a,e[u[0]]=s[0],e))(r({},t,{chart:et(n,"left-axes-view")})),I(((i={})[l]=a,i[u[1]]=s[1],i))(r({},t,{chart:et(n,"right-axes-view")})),t}function ie(t){var e=t.chart,i=t.options,r=et(e,"left-axes-view"),n=et(e,"right-axes-view"),o=i.xField,a=i.yField,s=i.xAxis,l=i.yAxis;return e.axis(o,!1),e.axis(a[0],!1),e.axis(a[1],!1),r.axis(o,s),r.axis(a[0],Mt(l[0],ht.Left)),n.axis(o,!1),n.axis(a[1],Mt(l[1],ht.Right)),t}function re(t){var e=t.chart,i=t.options.tooltip,r=et(e,"left-axes-view"),n=et(e,"right-axes-view");return e.tooltip(i),r.tooltip({shared:!0}),n.tooltip({shared:!0}),t}function ne(t){var e=t.chart;return O(r({},t,{chart:et(e,"left-axes-view")})),O(r({},t,{chart:et(e,"right-axes-view")})),t}function oe(e){var i=e.chart,n=e.options.annotations,o=t(n,[0]),a=t(n,[1]);return C(o)(r({},e,{chart:et(i,"left-axes-view"),options:{annotations:o}})),C(a)(r({},e,{chart:et(i,"right-axes-view"),options:{annotations:a}})),e}function ae(t){var e=t.chart;return z(r({},t,{chart:et(e,"left-axes-view")})),z(r({},t,{chart:et(e,"right-axes-view")})),z(t),t}function se(t){var e=t.chart;return E(r({},t,{chart:et(e,"left-axes-view")})),E(r({},t,{chart:et(e,"right-axes-view")})),t}function le(t){var e=t.chart,i=t.options.yAxis;return A(r({},t,{chart:et(e,"left-axes-view"),options:{yAxis:i[0]}})),A(r({},t,{chart:et(e,"right-axes-view"),options:{yAxis:i[1]}})),t}function ue(e){var i=e.chart,n=e.options,o=n.legend,a=n.geometryOptions,s=n.yField,u=n.data,c=et(i,"left-axes-view"),g=et(i,"right-axes-view");return!1===o?i.legend(!1):l(o)&&!0===o.custom?i.legend(o):(i.once("beforepaint",(function(){var t=u[0].length?Pt({view:c,geometryOption:a[0],yField:s[0],legend:o}):[],e=u[1].length?Pt({view:g,geometryOption:a[1],yField:s[1],legend:o}):[];i.legend(r({},o,{custom:!0,items:t.concat(e)}))})),a[0].seriesField&&c.legend(a[0].seriesField,o),a[1].seriesField&&g.legend(a[1].seriesField,o),i.on("legend-item:click",(function(e){var r=t(e,"gEvent.delegateObject",{});if(r&&r.item){var n=r.item,o=n.value,a=n.isGeometry,l=n.viewId;if(a){if(function(t,e,i){void 0===i&&(i=0);for(var r=i;r<t.length;r++)if(e(t[r],r))return r;return-1}(s,(function(t){return t===o}))>-1){var u=t(et(i,l),"geometries");y(u,(function(t){t.changeVisible(!r.item.unchecked)}))}}else{var c=t(i.getController("legend"),"option.items",[]);y(i.views,(function(t){var e=t.getGroupScales();y(e,(function(e){e.values&&e.values.indexOf(o)>-1&&t.filter(e.field,(function(t){return!v(c,(function(e){return e.value===t})).unchecked}))})),i.render(!0)}))}}}))),e}function ce(t){var e=t.chart,i=t.options.slider,r=et(e,"left-axes-view"),n=et(e,"right-axes-view");return i&&(r.option("slider",i),r.on("slider:valuechanged",(function(t){var e=t.event,i=e.value,r=e.originValue;V(i,r)||Qt(n,i)})),e.once("afterpaint",(function(){if(!q(i)){var t=i.start,e=i.end;(t||e)&&Qt(n,[t,e])}}))),t}function ge(t){return S(Yt,Zt,ae,$t,ee,ie,le,re,ne,oe,se,te,ue,ce)(t)}var de=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="dual-axes",e}return x(e,t),e.prototype.getDefaultOptions=function(){return r({},t.prototype.getDefaultOptions.call(this),{yAxis:[],syncViewPadding:!0})},e.prototype.getSchemaAdaptor=function(){return ge},e}(H),he=J({props:{data:{type:Object,default:()=>({column:[],line:[]})}},setup(t){let e;const i={data:[t.data.column,t.data.line],xField:"date",yField:["value","count"],geometryOptions:[{geometry:"column",isStack:!0,seriesField:"type"},{geometry:"line",label:{style:{fill:"#626681"}}}]};return K((()=>{e=new de("columnContainer",i),e.render()})),Q(t.data,(t=>{e.changeData([t.column,t.line])})),()=>Y("div",{id:"columnContainer"},null)}});var fe=J({setup(){const t=Z(!0),e=Z({column:[],line:[]}),i=Z(""),r=async()=>{const i=await U();e.value.column.splice(0,i.length,...i),e.value.line=(t=>{const e={};return t.forEach((t=>{e[t.date]>=0?e[t.date]=e[t.date]+t.value:e[t.date]=t.value})),Object.entries(e).map((([t,e])=>({date:t,count:e})))})(e.value.column),t.value=!1};return K((()=>{t.value=!1})),Q(i,(t=>{"MzMz"===btoa(t)&&r()})),()=>Y(X,null,{default:()=>{return[Y($,{value:i.value,"onUpdate:value":t=>i.value=t},null),Y(tt,{title:`总计营收：${r=[...e.value.column],r.reduce(((t,e)=>t+e.value),0)}`,style:{"margin-bottom":"24px"},loading:t.value,bordered:!1,"body-style":{padding:0}},{default:()=>[Y("div",{style:"min-height: 400px;margin:12px 24px"},[Y(he,{data:e.value},null)])]})];var r}})}});export{fe as default};
